#include "KISA_KBKDF.h"
#include <assert.h>
#include "util.h"

//KDF-CTR(HMAC-SHA256)
void test_kbkdf_hmac_ctr()
{
	uint8_t KI[1024] = { 0, }, Label[1024] = { 0, }, Context[1024] = { 0, }, KO[1024] = { 0, }, right_KO[1024] = { 0, };
	uint32_t KILen = 0, r = 0, L = 0, LabelLen = 0, ContextLen = 0, KOLen = 0;

	printf("KBKDF-HMAC-SHA256-CTR\n");
	printf("r=8, L=128 \n");
	r = 8;
	L = 128;
	KILen = asc2hex(KI, "133D114B66EE3D4737720B127900A3C23C783658D2F73FF030A8093B96DD712F");
	LabelLen = asc2hex(Label, "735EEDFD8300CD443A7AC18465759CD50FE257D9A19059EF4EFEF5A9AE6E3581A93AD6C7976B93DEA588A7A87BAC8D3F1CDB0AE60D966D3FB9AD16BE");
	ContextLen = asc2hex(Context, "1455355D7F7AD491EC57187D4243C36603CEFE682C0C56675C310448395E71600FBBF92CBBC6EF43C8EBE28AD7541FA7440277B8061D4344D788A571");
	KOLen = asc2hex(right_KO, "E8068DF95DAC4896B25B46F188DEC662");

	kbkdf_hmac_ctr_mode(KI, KILen, r, L, Label, LabelLen, Context, ContextLen, KO);

	assert(memcmp(KO, right_KO, KOLen) == 0);

	printf("r=8, L=256 \n");
	r = 8;
	L = 256;
	KILen = asc2hex(KI, "4D09B9B29A97F0A632B04024AF98ADB1CF2389E51BCA3A1FC6FE3D77D7BD6BF4");
	LabelLen = asc2hex(Label, "8B627B00F4C1C918E77355C8156F0FD778DA52BFF121AE5F2F44EAF4D2754946D0E10D1F18CE3A0176E69C18B7D20B6E0D0BEE5EB5EDFE4BD60E4D92");
	ContextLen = asc2hex(Context, "ADCD86BCE72E76F94EE5CBCAA8B01CFDDCEA2ADE575E66ACAE59B34A85036C37AFEEA9C097F0BE74DE2E05D9457ADE5DCEDFF38F1E79C18F268A54C3");
	KOLen = asc2hex(right_KO, "0FE983EDB298EDF63CC685A877EECD17CEDE1EA7C486EFEDC070639C8F0A78D3");

	kbkdf_hmac_ctr_mode(KI, KILen, r, L, Label, LabelLen, Context, ContextLen, KO);

	assert(memcmp(KO, right_KO, KOLen) == 0);

	printf("r=8, L=160 \n");
	r = 8;
	L = 160;
	KILen = asc2hex(KI, "FDAD31987CB3D7BC0C5349B28612C64EBF7F73ADB0C4A26BD47A5316D2C2FBE3");
	LabelLen = asc2hex(Label, "5C9185A0574B97EA3C9416A0BE63EC98AD5709901A4FA767BC35D38D921A29B8CA88DFD8E213054E0D320A58D84D83D00D172817D71E1F4C28A17EC1");
	ContextLen = asc2hex(Context, "58A10BAF0F3A46286434A94E46D62EC31BFA1260A867D82A315A9281E1665C9B6C7E2931F251C27827D60B53B12788C7D19221AF46ED22B16E2B8670");
	KOLen = asc2hex(right_KO, "F1BA03AFA4BCFBFA6C510A54F4637E76CC2498B3");

	kbkdf_hmac_ctr_mode(KI, KILen, r, L, Label, LabelLen, Context, ContextLen, KO);

	assert(memcmp(KO, right_KO, KOLen) == 0);

	printf("r=8, L=320 \n");
	r = 8;
	L = 320;
	KILen = asc2hex(KI, "1F1882F48063951E1A9256311831F0409305E458B59F4DB31F31682E89A153FD");
	LabelLen = asc2hex(Label, "A8DC159E556DDF0BEB4E9234F1FD80ACF9D377A3C792FC14B63DD43F582CC95A5D5FAA84B61394FAFA93708D0851BD54EE35909E0935D82A6E26E79B");
	ContextLen = asc2hex(Context, "89D12E26044A488EEA7D3B520D0AFA25A5532E9E39D23531C3B16B5E0F94A92864BA0CC96644F8A43BD45C7BED5A37E20F2B5BF3A45471443C2D3D16");
	KOLen = asc2hex(right_KO, "9CA0FF74F3231134FE085AA07F88CF7095F65C535954C1D7E3DD825610F3D079706874A485725160");

	kbkdf_hmac_ctr_mode(KI, KILen, r, L, Label, LabelLen, Context, ContextLen, KO);

	assert(memcmp(KO, right_KO, KOLen) == 0);

	/******************************************************/

	printf("r=16, L=128 \n");
	r = 16;
	L = 128;
	KILen = asc2hex(KI, "521E92625E551C735EFE6BE910EBD554115A75F2FE8173DBD96A857CAF01B646");
	LabelLen = asc2hex(Label, "786C67A73F9A933A831F573BDC3FB13DE248881F4A26EC3C5231A0E26049D506E525393588E830CE81F5616F420575AD5D771B08A2E7501D8701DD1E");
	ContextLen = asc2hex(Context, "CE97218061F210F381667C971F29946D8A66AA0C4B8C39954DEC26E8428346184114211DB47BF5C9713DFEFE2763F51DFC89D7C17432E7AE955EF604");
	KOLen = asc2hex(right_KO, "B2A8EBD493D6D302B9A303993E33631D");

	kbkdf_hmac_ctr_mode(KI, KILen, r, L, Label, LabelLen, Context, ContextLen, KO);

	assert(memcmp(KO, right_KO, KOLen) == 0);

	printf("r=16, L=256 \n");
	r = 16;
	L = 256;
	KILen = asc2hex(KI, "9EA9A0244DE45BEE3F6227FC067EC29D012A267E8086C2D72AB10BE29CDE3391");
	LabelLen = asc2hex(Label, "53AB3880CCAF2129E952855797E24CDDAEE3B98719A6A951361D15D77FEDDE0D6BC5CA308FEEC9FC09247E201EA5FAEF2287CB58984E35189BBEBF2E");
	ContextLen = asc2hex(Context, "7DEEF28FAD9E5D1CDECADCD165801A3FE3EE553C25BF61D948A8F094213D10CFDC0AF581E2DFF92C016BE10FC70C629C2EE6E42C7F3385F270D9612D");
	KOLen = asc2hex(right_KO, "17FA3ADA5F55C3EE4F0EACA9DB2CC074181EABE377F5B751B4B526BD87E5FAF4");

	kbkdf_hmac_ctr_mode(KI, KILen, r, L, Label, LabelLen, Context, ContextLen, KO);

	assert(memcmp(KO, right_KO, KOLen) == 0);

	printf("r=16, L=160 \n");
	r = 16;
	L = 160;
	KILen = asc2hex(KI, "4AE62CBFC4AB820264CA68CDD063486E6960343F74072AD878CF9783E67319F1");
	LabelLen = asc2hex(Label, "FF46892BF3C639CA46737A6B78E2625EE50DCC9EEAED9F06494B54C1CFD3B203346ADCF642C18EF8392AA40373ABDC6C4451DCD124C7774D10272CED");
	ContextLen = asc2hex(Context, "2D10EF68AFF92D0AF9C50AF20597ED7D07E73E024DD66EC06ABE3814930E27F049555988399C824E60F9332172615DC17DBE1187C941895304FA6CC5");
	KOLen = asc2hex(right_KO, "CA1BB5ED4AF28C5CB388848B15619CBDAD1814AC");

	kbkdf_hmac_ctr_mode(KI, KILen, r, L, Label, LabelLen, Context, ContextLen, KO);

	assert(memcmp(KO, right_KO, KOLen) == 0);

	printf("r=16, L=320 \n");
	r = 16;
	L = 320;
	KILen = asc2hex(KI, "DD3EF4F579860063B4804E008655355A922721B84FA1DA5369D209C3653BF8B8");
	LabelLen = asc2hex(Label, "852699EAEB3ACA53004DD79B177940D44E72BD67B516804EB346BA84A5F560BAC77E2F4C583BEE73F953F3BC57D3E8B90901CFF6BCED442E8D4802BF");
	ContextLen = asc2hex(Context, "B679A95C6DEEBF0209B0F42D673BAA4B8C8CB4718B7B5E4DA94BAE5CC080EA5CE1F05A053D1D4FF446C265E811AC0430FFCB2D649C897354C75A473E");
	KOLen = asc2hex(right_KO, "40DCEE36BE928FCC568DA435B83C614EA1E508457141A8F955EAF702C95BDFE1BCFE521C9DF1F446");

	kbkdf_hmac_ctr_mode(KI, KILen, r, L, Label, LabelLen, Context, ContextLen, KO);

	assert(memcmp(KO, right_KO, KOLen) == 0);

	/*************************************************************/

	printf("r=24, L=128 \n");
	r = 24;
	L = 128;
	KILen = asc2hex(KI, "1D5DF7C8658E8303571038787E51983301E9A9ADC92E40FBE6027F452FF09D7A");
	LabelLen = asc2hex(Label, "2978E5422BA60234BFEA794A4A237791F0FDCD25B27D395DD9DAE743988F3747EDAEC134C87797626F29C92E21182FA7F900628A16990C71F96B6247");
	ContextLen = asc2hex(Context, "2EE4EEFF2FA892858528CAF53076310C495847DCE69B71C33EA9419D0E5EF8393B18490AB80D601FAAE22355CA79B8CC0B0A47977E7501B872D6614B");
	KOLen = asc2hex(right_KO, "F5EBD6718627D160F34128BDB7FD9B3F");

	kbkdf_hmac_ctr_mode(KI, KILen, r, L, Label, LabelLen, Context, ContextLen, KO);

	assert(memcmp(KO, right_KO, KOLen) == 0);

	printf("r=24, L=256 \n");
	r = 24;
	L = 256;
	KILen = asc2hex(KI, "122E757DBE20FB15B344C5574F90C00D7D53CD1FDAC90CC116EC5AEB9C8E1809");
	LabelLen = asc2hex(Label, "75A52FF569E650226895811A299BD52A11D97A5B56BCF9A56411BA60801BC7FBABE3D1F0C9D078F70277C77B69B4FE4ADBFA95902AE77D067B1CA967");
	ContextLen = asc2hex(Context, "ED4BCD247C9166582407FAFE4994A1625605C4D5A55F25A59F731F4C24B430E82D46B4EBAF57F314C3B25E9E059116B739B3AE3335AF3282FB8868DF");
	KOLen = asc2hex(right_KO, "78058B821BBCEA422CD5053FD5855DA25FBE25DA2275F1A1C658F81A6B7E8BC5");

	kbkdf_hmac_ctr_mode(KI, KILen, r, L, Label, LabelLen, Context, ContextLen, KO);

	assert(memcmp(KO, right_KO, KOLen) == 0);

	printf("r=24, L=160 \n");
	r = 24;
	L = 160;
	KILen = asc2hex(KI, "02DCEC96FAD6960D6F27D400D18D3C3B0F4ECB52B7CD2CDA5E5B37D8424FB97A");
	LabelLen = asc2hex(Label, "2E5973059E13650F24D94CEE0ADB6970397084CD59AE31D93A37527E7355DD6A494ADF05D2E1C1A65A49CA060523E6F5B6DAA64B303387227B257742");
	ContextLen = asc2hex(Context, "8AEA95DD1A56397DDD68343AD81F5930098E3C304E3339B68285B81BE9CCB00CCE356A3B6A26885408CF45336702FE546044F28BC82446F598CB4C2E");
	KOLen = asc2hex(right_KO, "81DC30C13ECF88A18223E3B4F4BFDBC86C91B3CF");

	kbkdf_hmac_ctr_mode(KI, KILen, r, L, Label, LabelLen, Context, ContextLen, KO);

	assert(memcmp(KO, right_KO, KOLen) == 0);

	printf("r=24, L=320 \n");
	r = 24;
	L = 320;
	KILen = asc2hex(KI, "76D21BD5D28BC49D730584171B04DB4FFC0723C9D8D5D0B86759F770F9AF0D1E");
	LabelLen = asc2hex(Label, "5C7FF2B7008A2D2E59827AEA851F82772F6FE97CB36E8DED82D60D81C93889674D4CA9359986E1215CE9F3730D20B53AD0CB143E9D1759379F91AB3C");
	ContextLen = asc2hex(Context, "DA3CD57E11E04A36E7A666DC44E2F79AFA30FC00A9C2ADF9E0F8BBFE8431D88976E27ACD70E5DCA4301346C9D9148F479676E03180FDBA94C23A3BAA");
	KOLen = asc2hex(right_KO, "160469C921317244D2ABACF1CFFBB216451F910E776879FC45A61574D6455B0EE5288C65AE6C1B51");

	kbkdf_hmac_ctr_mode(KI, KILen, r, L, Label, LabelLen, Context, ContextLen, KO);

	assert(memcmp(KO, right_KO, KOLen) == 0);

	/**********************************************/

	printf("r=32, L=128 \n");
	r = 32;
	L = 128;
	KILen = asc2hex(KI, "33BA023F3C5A34B8E468337F83F0AC1ECCE79347F4BD670E1731B756D769E589");
	LabelLen = asc2hex(Label, "46422A8D06E5DAF3AE9BE97170E2AF92F9C0E8AC9957FF13A4BA8C8C18FF1B047F952F8217D8865B31E39FA5D7A57AEDB1389F2D2A6D61F8CEAC64F8");
	ContextLen = asc2hex(Context, "F6FB5D9AA85C1908B95CC15834E95C0200649598BCF7BEB1EE2916275DAF4782BB8533B3873EF0063299115281542872324589F9E2A650222EB1A506");
	KOLen = asc2hex(right_KO, "EC40EF8B120BF0A3329BC8B9000BF74E");

	kbkdf_hmac_ctr_mode(KI, KILen, r, L, Label, LabelLen, Context, ContextLen, KO);

	assert(memcmp(KO, right_KO, KOLen) == 0);

	printf("r=32, L=256 \n");
	r = 32;
	L = 256;
	KILen = asc2hex(KI, "4081DF166E9ED4912B1B815AA08CFEB9459A1AD0029E9FD0956FD76C33774E8E");
	LabelLen = asc2hex(Label, "720DDA4966FFD9100A6DBA25E2DEBF53DF8D00E08304B4BE45ECAC0137242096E610AE318234A0873F016EBEFAEE832120CB4419CC524F582F000058");
	ContextLen = asc2hex(Context, "35233A04653364B50A65B15F907EA50D30E5D58AD0FDEE6124B1F8081A51DC59759C2441B71E03BC45BC9501C68D67F9CCEB3AF6B6CA04A2D5493836");
	KOLen = asc2hex(right_KO, "2349776427BAE9CB5CFCDA11C77B41B97E07F134B25DA10D72398BBEBCA75658");

	kbkdf_hmac_ctr_mode(KI, KILen, r, L, Label, LabelLen, Context, ContextLen, KO);

	assert(memcmp(KO, right_KO, KOLen) == 0);

	printf("r=32, L=160 \n");
	r = 32;
	L = 160;
	KILen = asc2hex(KI, "E65031DDE1F2D49CEE2A4D0C4A5260736F0BF7A539D5673048DDF5D6A5159940");
	LabelLen = asc2hex(Label, "A88A02F019F3D97895854AE9330FC18F6842F1DB28501BA14EBA8D843E6269AEC9E8A7C451335D182D4E3E214E76612923714546BB21118B2A58207F");
	ContextLen = asc2hex(Context, "2DEEBCCE11112A3FD0DDE8E67E2C329BE3B0CAAB6A3FF9CD3A6DD157A260B6B1BAE01D0A47AE924BE01700494FC82D3F3AE4847B03541757EC5FE46B");
	KOLen = asc2hex(right_KO, "92074A6B2277F65EFDC365B08D22731C7E1D0387");

	kbkdf_hmac_ctr_mode(KI, KILen, r, L, Label, LabelLen, Context, ContextLen, KO);

	assert(memcmp(KO, right_KO, KOLen) == 0);

	printf("r=32, L=320 \n");
	r = 32;
	L = 320;
	KILen = asc2hex(KI, "AA94B8564A32A28B14E0B63797FEA2E19165AA4A10FCF0A1D786F2F603BE54F1");
	LabelLen = asc2hex(Label, "EFA6E0C4541CCB5EB5AE39E1FAAF04575B8AB9A17F57E4AFE5AC8EF784B6031FAE88D9FD3AB22DC2E2163072EAF7E39803531E376E73D70364C0A1D1");
	ContextLen = asc2hex(Context, "B6D8734DB1E1ABEB441E522065BFA2D1B0FEC50C5167E0F6257750041C69346EE24D2BE1BE5A5F75BA85C2DE045397E694EB351B0F6F07C4EB8CD81A");
	KOLen = asc2hex(right_KO, "13188EC5D8FE47750DD2E7FD70AC0744B29B2249E6B4786CDC1CD7A822ADBC88ED860215C5112737");

	kbkdf_hmac_ctr_mode(KI, KILen, r, L, Label, LabelLen, Context, ContextLen, KO);

	assert(memcmp(KO, right_KO, KOLen) == 0);
	
}
//KDF-FB(use CTR)(Not allowed Null IV)(HMAC-SHA256)
void test_kbkdf_hmac_fb()
{
	uint8_t KI[1024] = { 0, }, IV[1024] = { 0, }, Label[1024] = { 0, }, Context[1024] = { 0, }, KO[1024] = { 0, }, right_KO[1024] = { 0, };
	uint32_t KILen = 0, r = 0, L = 0, IVLen = 0, LabelLen = 0, ContextLen = 0, KOLen = 0;

	printf("KBKDF-HMAC-SHA256-FEEDBACK\n");
	printf("r=8, L=512 \n");
	r = 8;
	L = 512;
	KILen = asc2hex(KI, "133D114B66EE3D4737720B127900A3C23C783658D2F73FF030A8093B96DD712F");
	IVLen = asc2hex(IV, "735EEDFD8300CD443A7AC18465759CD50FE257D9A19059EF4EFEF5A9AE6E3581");
	LabelLen = asc2hex(Label, "A93AD6C7976B93DEA588A7A87BAC8D3F1CDB0AE60D966D3FB9AD16BE1455355D7F7AD491EC57187D4243C36603CEFE682C0C56675C310448395E7160");
	ContextLen = asc2hex(Context, "0FBBF92CBBC6EF43C8EBE28AD7541FA7440277B8061D4344D788A57196B91078E9C80A5726C530C6744F7B6B2D62C3518771819774B5D965C6C4D824");
	KOLen = asc2hex(right_KO, "559EDACD70ACAF93AAA26DBFB91096AA10DB1E1434EB3198CFDA2A9B1ADC5777F138C9730F204E75A1CB74339AE2517B1C2EB2C83690F11D46F8713E72CAE8C3");

	kbkdf_hmac_feedback_mode(KI, KILen, r, L, Label, LabelLen, Context, ContextLen, IV, IVLen, KO);

	assert(memcmp(KO, right_KO, KOLen) == 0);

	printf("r=8, L=2048 \n");
	r = 8;
	L = 2048;
	KILen = asc2hex(KI, "32B04024AF98ADB1CF2389E51BCA3A1FC6FE3D77D7BD6BF48B627B00F4C1C918");
	IVLen = asc2hex(IV, "E77355C8156F0FD778DA52BFF121AE5F2F44EAF4D2754946D0E10D1F18CE3A01");
	LabelLen = asc2hex(Label, "76E69C18B7D20B6E0D0BEE5EB5EDFE4BD60E4D92ADCD86BCE72E76F94EE5CBCAA8B01CFDDCEA2ADE575E66ACAE59B34A85036C37AFEEA9C097F0BE74");
	ContextLen = asc2hex(Context, "DE2E05D9457ADE5DCEDFF38F1E79C18F268A54C302CB51CC21003AB9A7CFEE7A0FD26F9715EBE822D3D8EFEA2A0707F163AB6920160F043A4B2AC20F");
	KOLen = asc2hex(right_KO, "FC911A497D217937FB3AD29121B66175F7A5E394CBDD99FEDE3C41930CAFB82989D123535BB0D2BB2D168F2539191BD16D61645E60704AE1A65CAC0EEF507438C76ED76C3F9FA37E5DB3DDE029D88D92E907CE73D4608ACB1E89A0A3FE9AD1FCEF9EC55E2B69FE70D7E5616D82D54203A775A1641D7B7BDB75C7C9785972C869D17A04BF77918979BF5A1E0DCA359A0FA1497C91EAA6BC2E4806FD73FAD5F457A784E8755DE45D64C2F1AC523B9159A20462D06759744CE41F3E3EE18D353508B8B11CA4C3D9E766FB3C0194142D3CF7DE02D73BDE972389DFEB47CFA28EABEC8D50616310F3500DE3A522BFB315A71F31FAE2A46789CF52B37131B3A16A2E3B");

	kbkdf_hmac_feedback_mode(KI, KILen, r, L, Label, LabelLen, Context, ContextLen, IV, IVLen, KO);

	assert(memcmp(KO, right_KO, KOLen) == 0);

	printf("r=8, L=528 \n");
	r = 8;
	L = 528;
	KILen = asc2hex(KI, "0EC02A1AB1EAB69EF00BF244291FC3F5F46631214EFFB2F8F7B8ABDD18253417");
	IVLen = asc2hex(IV, "29EF1CCA126F2C26907BB0DFDB8034DD86D18C34A63F175636EA4488BA575492");
	LabelLen = asc2hex(Label, "23C262BBF3B5A1F4A1D9E6543F0D66C45AB5C0FC22543EAECA5E570032477940C4E006D39CE39D6FEBCC9A8B9DEBE01339B8D65F0966AF667CBBEF2F");
	ContextLen = asc2hex(Context, "C81E2A89D3F20FFC5422A6FF35FDD66B3D452A30EB82D547A59CF3E812A911FCC404F0D51A9F861D649A460C4914A1DE6641CD8538BCC59B3C1F919A");
	KOLen = asc2hex(right_KO, "A78E40D9CABDD9D295B610901F38888AA9AF37BC2EFBCD2CFBAC02F3110CF50D1501E26CB6A37DF23307259BC5DC68052E87AAC14AB7D1E42FAC4D01D8ABE22BBA6C");

	kbkdf_hmac_feedback_mode(KI, KILen, r, L, Label, LabelLen, Context, ContextLen, IV, IVLen, KO);

	assert(memcmp(KO, right_KO, KOLen) == 0);

	printf("r=8, L=2064 \n");
	r = 8;
	L = 2064;
	KILen = asc2hex(KI, "36B9E9E24C3F4252CA970104247AC7A8983B6A49575A3D80E55791E8C2C47BD1");
	IVLen = asc2hex(IV, "4A9ED839DADD8FF8344A163A259138326597150DBE0D6A2570461278D545CD58");
	LabelLen = asc2hex(Label, "411B41642C703EB6935F465E9B874D0F785EBD198DC9BD97D4EAB3EA81390766E2D72B4A8A1FD8F6AE7D9A58CF838EA899396A550CB5BF3FD9EC7B26");
	ContextLen = asc2hex(Context, "0FC8B262F67B9ED53B12E41F4E4D181009AE846392D025A982FAF78347F47314C71955B645AEA2EC8972EA993B76CA6F912FB6A92ACAF5FD39BFEDCC");
	KOLen = asc2hex(right_KO, "4034A05138EE66E64D0D76016C9A7AD78ABAEB7100A7974547A9EA60B79A5DD02C839667E02AA7EBC84B16871D79DC1BB1890B770E03161693D351230ECD4DD7CD2C4200B474AAD85E325C914F3F03D03D541ECEAA2880C9E8440586B15A5B7CC3626C5C9B7A7B57C063A8C94E16125ACAAC2CD778ADE0CE8827ABA66BC1402C6B04A96E239098146C03A6A09DF923296E9064898B397405AFAE716F829FB8D042CEDA61C06499A921677141D7B22B53810E4639ED4040D9CD0E56AF86247AC9E291A9E0A1675CCC83BD081C0AD0D71A18A0C5BEB8270A4277ECAE10AE5F87C3109A3FCDB82CAE58966CE8B152FD72A13F649E920242969D650F4237D57665860EE5");

	kbkdf_hmac_feedback_mode(KI, KILen, r, L, Label, LabelLen, Context, ContextLen, IV, IVLen, KO);

	assert(memcmp(KO, right_KO, KOLen) == 0);

	/******************************************************/

	printf("r=16, L=512 \n");
	r = 16;
	L = 512;
	KILen = asc2hex(KI, "C46955AF35158E885AD4083546791941A418567C551759AC5B88C280F6B67CC5");
	IVLen = asc2hex(IV, "0CFE42DCCEE1616C9957BF541A651CE4B6F1984C29D675546D341F4EDD096949");
	LabelLen = asc2hex(Label, "9A061A882E9BA8336F55434BA66915E3F191C98EE6164A14792ECD69208911DF3527E59A9B6CEC44A4769D0332AE8DA81D9DF12AD5025E524921D4B7");
	ContextLen = asc2hex(Context, "075DFBEDA409ACFA5E7CB3090063D463065C0C9A02C018073EBF3C77A3B33D22D9AEAFDDB0557790BFF288E94BC4F0526A9A182167A0470F697869EC");
	KOLen = asc2hex(right_KO, "2182C50EF2DE4DFFAC26C63020A62F888175ECF8B09AF7AC6448036D5D13E70031CAC38A36EC32C996BE66F5AE0BCAA1DCADB3DE50A00C539AB3A0D2FC93166A");

	kbkdf_hmac_feedback_mode(KI, KILen, r, L, Label, LabelLen, Context, ContextLen, IV, IVLen, KO);

	assert(memcmp(KO, right_KO, KOLen) == 0);

	printf("r=16, L=2048 \n");
	r = 16;
	L = 2048;
	KILen = asc2hex(KI, "F2DA88FD11ACC665AF8D323A2978A57EC7A4512DE31101724E61A21BEFEA034B");
	IVLen = asc2hex(IV, "AD09D96E90B9067222641B351CF91B393E3E829F7F68855366E99C84B8893E57");
	LabelLen = asc2hex(Label, "53B8EBDC5A227041928567450CBFFDF0052CF8810A2EF8A9600DFCF6A2022992AC8EC72DB8108D38C7971E5443F5D30AE215BBBCCD8EE0DB0277CC5B");
	ContextLen = asc2hex(Context, "F67E4C647F34744BF2ABE3C08843494907C126EF9EA1D43610AEC75315CF149AFD2430369651FA1C501AFC429F31EE0BA14B7C0601794AD91BB63478");
	KOLen = asc2hex(right_KO, "4B6E2EE6343A734D0D319D0AF33D2ABDF31FC1BE5EB27355126EADAB319140C779D1E3A04443502AC9365EC08669C48590AEE3449022A7996D6D82530EF68C35CE0FA6988B02F3FA162BD945EBB80E6DA5BB7549AF526EFB3111B14530F5FCF8A550FC355F26934BFA301C4981BDAC70DA88F1C327F7ABDF525B9FBB96A112B019EC54C50E263E171AC47C59898F8D5ABD52A85B3B13C3967B5BD37C53CD3ED72BCFD8EDE0FBB6E58F094BFECC4C665A31F6B39EFD0585C9C8DAA9B3314854AFDD2E7109DC25B560E8AC23264AE7BF71DE0B6E5220FD312F641BCA059831B1C67DF0352DEBB2C8B3CDA1E3140283B1433AAC8C14F5B8A60EA4F72AA56A6B11AA");

	kbkdf_hmac_feedback_mode(KI, KILen, r, L, Label, LabelLen, Context, ContextLen, IV, IVLen, KO);

	assert(memcmp(KO, right_KO, KOLen) == 0);

	printf("r=16, L=528 \n");
	r = 16;
	L = 528;
	KILen = asc2hex(KI, "E7DCDAFA3DBDD18E5C11069A7456D1A93392F111E9E7CE26EA6800AD342B1594");
	IVLen = asc2hex(IV, "519F8FE07F202DE60FC96CBE0B8A4CF51B7A5782A96EE0FB44CA89094297081A");
	LabelLen = asc2hex(Label, "AAD62A55511417D3423FD90C63B8188F56A927F79E99451A033E1C8337928E23B929B143FAC118BDBF1B556CC609BBE1ACC969570E9184E9EF6BC303");
	ContextLen = asc2hex(Context, "59433117473E2E91C34EB70C4C04E8C67AA5BF51E57F238C427D25D2CFFA8571F2D3785E1CC0A827F4E47D28B2A29B02C8B3AC49C8755F7D8286B03C");
	KOLen = asc2hex(right_KO, "AED2DC88D80AEDA97A8B840181DBA5297178A79FDC20FCC525EE815DC47D526C2EB1F6029DB85DBCB040B69442BA0F1CB84F5D71D6F40042B025E0AFA26A638A7E85");

	kbkdf_hmac_feedback_mode(KI, KILen, r, L, Label, LabelLen, Context, ContextLen, IV, IVLen, KO);

	assert(memcmp(KO, right_KO, KOLen) == 0);

	printf("r=16, L=2064 \n");
	r = 16;
	L = 2064;
	KILen = asc2hex(KI, "EE7CE51D07C68212066DE32F30AF1DC7D9A2BAC985CA02F24CEB7941831CA8AC");
	IVLen = asc2hex(IV, "981D20113EEABD6FCA902856DD409F9C44A2F9521C6BE4F63A3272EACA80D425");
	LabelLen = asc2hex(Label, "3526652949D3EA3594E517BB1080561406DDC5732CE57D1810FF1AC6BA2678768D3EBA4D6FA891CC2A14BB471196C998E6FD2614FB6055BE98F97ABB");
	ContextLen = asc2hex(Context, "9D361C06680E2965F9923A9C54C419E027AB818EADA7241DD203F25298C999B2B9DA483D8E3DB9592FB86E0DDC9D3B6F9CE704602385C876F9F6DE3A");
	KOLen = asc2hex(right_KO, "1F070FD24036B3F27172526BFC5D6E464C726B7AE02E2D1FB13483A1BAB21B15A3CD2BED30B63AD52FE798E9BE3AF65684F2C0BC55D410C8E721DDE3ECA0D792B422F27E95359FB124EBAB302F0A4D21CA65F9C53FBC6B454A1E92B0C78680A9E264266C432A2929ADFFFBC15EEC60F4790C33743BDFFED6645AF7CB487745314D98034B2930A92DDCDDAFC3A7C3453709136E9A529D81BC8F126CFE07903CBB1D0D50335526D9E092099719B994553655CEB9C22494AA087CAD1F949A047CBD6831DD77A37C3516882DA3293EFB9790D03D9FD10D7CAA2774678D86553D3F7774EE8AFDF617E144533E93C906EA860F9BB4E154DA72BD7C99A3E2DA8A8DB8E30672");

	kbkdf_hmac_feedback_mode(KI, KILen, r, L, Label, LabelLen, Context, ContextLen, IV, IVLen, KO);

	assert(memcmp(KO, right_KO, KOLen) == 0);

	/*************************************************************/

	printf("r=24, L=512 \n");
	r = 24;
	L = 512;
	KILen = asc2hex(KI, "D645025C8F6503771F4EC20E203F517CCAA146891798069C26D8442CDDBAC478");
	IVLen = asc2hex(IV, "D38E65786D335E1347E6C892D5585D554A037FC4B8BD7C89798E10FDCFBF2BDF");
	LabelLen = asc2hex(Label, "C733F54C63FB0FEBF7241C69D4D381252495682C15F00B673A3E2F132EBBEE727ADCBAC0B8E29F69F9B0C87965D9455421FE0CA776573D9E2F8FAA58");
	ContextLen = asc2hex(Context, "42D59698B330BDBDB61295F41431D4ACCF92324A09E6701E221A9996212A88B25536AAB83CD70529A3B379F30F4F46E85C25CF6FA4F79E7A6262A7B8");
	KOLen = asc2hex(right_KO, "B1A73414F4631DC0073887D716F83655307C580724F536D47D1D5F91AF6E4A489DD6CD036582AAEB2BF444AA272C7237A3179DE57A45AD71D1D76D97D822FBC0");

	kbkdf_hmac_feedback_mode(KI, KILen, r, L, Label, LabelLen, Context, ContextLen, IV, IVLen, KO);

	assert(memcmp(KO, right_KO, KOLen) == 0);

	printf("r=24, L=2048 \n");
	r = 24;
	L = 2048;
	KILen = asc2hex(KI, "B106C9EA3676BD8257A0DD8B430476AC579C6EC7436D8528685BDB038541B31D");
	IVLen = asc2hex(IV, "934176C9ED59FB16B4370547724F0D83FD2A42CE9F01CF38738A5C541212D7EC");
	LabelLen = asc2hex(Label, "6FCC74F30069F2BB1FE82169AFB0A1A502DCEC96FAD6960D6F27D400D18D3C3B0F4ECB52B7CD2CDA5E5B37D8424FB97A2E5973059E13650F24D94CEE");
	ContextLen = asc2hex(Context, "0ADB6970397084CD59AE31D93A37527E7355DD6A494ADF05D2E1C1A65A49CA060523E6F5B6DAA64B303387227B2577428AEA95DD1A56397DDD68343A");
	KOLen = asc2hex(right_KO, "A84F11EE3001C2EDD947E5531EA0068A0047AF3D9B3F81020EDD74D973052285AC09A4956D2865460A8415280E7208A52752BE4FABF494AE4455683320657CFA224AE0E1BD59C0ED675F31779E6AEA965D011E5C27B4462BB8EC4058002E57AB0C60CAB64C8D61B3BF0B12AB6162B543FD608FA04E04FE971F2D1C537925E3E501D2D65133FE9CB12FEDF382825E146C4DAFFC97BD3A51EF36427978ED4E94194859C5EE7B51F046F986FD38372E779DA7528AF2F8091263CDA0425452F6AE96940F050D294818B7540FE1BBFBFBE8486A57B1C25C2A973F93C69D50CFF349EA772A250B7FA2C09BAA7147C0B611B97815B1BDF7FF754EDAF1583FBB843F4398");

	kbkdf_hmac_feedback_mode(KI, KILen, r, L, Label, LabelLen, Context, ContextLen, IV, IVLen, KO);

	assert(memcmp(KO, right_KO, KOLen) == 0);

	printf("r=24, L=528 \n");
	r = 24;
	L = 528;
	KILen = asc2hex(KI, "D0CB143E9D1759379F91AB3CDA3CD57E11E04A36E7A666DC44E2F79AFA30FC00");
	IVLen = asc2hex(IV, "A9C2ADF9E0F8BBFE8431D88976E27ACD70E5DCA4301346C9D9148F479676E031");
	LabelLen = asc2hex(Label, "80FDBA94C23A3BAAFA5F9D50E352FFBA32006866BDF4094EE228C262271BE8351E2346F78C0561A3C9C301796AB5ECAF1EDBF564D67235D529C599D3");
	ContextLen = asc2hex(Context, "F6469D754BDD560A8580B651B9040CED5333CA13FD1E8B86C3B554C574941A824B208557CED3F4B5F7D4C11D92CBC692E6F3204E977132B4CBE4ED86");
	KOLen = asc2hex(right_KO, "DFBF3586FD2005D769D7525BBF83B0B0B45DF1ADB5774B1699484680E06C53753D2B6BB10890C3DC117B420E6786A5D89818FE7678B89BF8A6EAE63E5A31607CB1F1");

	kbkdf_hmac_feedback_mode(KI, KILen, r, L, Label, LabelLen, Context, ContextLen, IV, IVLen, KO);

	assert(memcmp(KO, right_KO, KOLen) == 0);

	printf("r=24, L=2064 \n");
	r = 24;
	L = 2064;
	KILen = asc2hex(KI, "C4E1FB0DA6A3BFDB298EE6F66862F856C9FB34CD25E0D43C2A1A9207FE426AC6");
	IVLen = asc2hex(IV, "25DEA23EA5EE088F68C17BAEE10DAC16F33F26BB0E108C409B5922699A288FD3");
	LabelLen = asc2hex(Label, "8913E2E388CCD2FCBCF64AF5F13725CA838F36917EE88BB004EEF24EEF20BD07B827C3E49867A78AECD55DB1DE08E9D842926A37BE9058F62E800A9C");
	ContextLen = asc2hex(Context, "46537BCA79C34D291AE70EA1C205BBCCF1A782AAF8F1CC9616317B78E1B8703DE7E95184968F899A597490A9042F6C2C723D78A66C536494CDF37DA0");
	KOLen = asc2hex(right_KO, "808F45A5BA81454AFE716969D18E49CC93FE0A78230AF08BA4E1870C19C3956ACFEADC94C4B795683B5CAD497349064E4EC989AC41F6F186EC1553B285105C497FEA3F8F168B6B8D968A5CA1B0217211E95EE928C8AC53709638A2373DDC73EA315783310931BBA33EA7359E93D6030C0FDEDB7072B6DF21CDC13324E7A9892C57315123A2A2E06EFB007D4EA87079B5D60449BAAA3ADF289C288866F8D96404B09E2AEFE04B95DD8A2784DF317CC4E9CB8B17A7B93D0D395CD933263AFCAF90615A8CCA815BC42FDB68EF7011A52EB13DD96914B315A17CBF12414E0F8FC4B2363DFB3426FD70BB68BB1F8A0C983CFAA9EA714B99680697A80C5C57781E80F7496D");

	kbkdf_hmac_feedback_mode(KI, KILen, r, L, Label, LabelLen, Context, ContextLen, IV, IVLen, KO);

	assert(memcmp(KO, right_KO, KOLen) == 0);

	/**********************************************/

	printf("r=32, L=512 \n");
	r = 32;
	L = 512;
	KILen = asc2hex(KI, "5ED5D84A70BA1AF4654388CEAC34A7D990B9C4C05FF9360ECCEFE39F92750654");
	IVLen = asc2hex(IV, "5AA22F0BDF568BCF5013654BF60FED85168738C9195589E2EAC5CF91A0A56E37");
	LabelLen = asc2hex(Label, "5D9B42D575BCE136D359216B991CDB780754EE4D9E8E86F885659E182B9BC3952E681B8E7C11A793B8BDC515DF85F91A2BCAEC3537CBB5B66576581E");
	ContextLen = asc2hex(Context, "7D7F8CD696B0C2203A80624DC5E658310E6FCFD4498F3C6A2C349F8551A1068ADC7A52615D1B3D71F82E9CCCC37DE2A66F04E60C2B4BE6D3C5F3CBCE");
	KOLen = asc2hex(right_KO, "25B5B839D63A5F9AF9D25F097B48C8DBE037F4D33DBDDF342533CCA205D0EC1FDF7E245A91D5E731B9139FBF29BF2190C903369439FE826AA05AB547001C3F77");

	kbkdf_hmac_feedback_mode(KI, KILen, r, L, Label, LabelLen, Context, ContextLen, IV, IVLen, KO);

	assert(memcmp(KO, right_KO, KOLen) == 0);

	printf("r=32, L=2048 \n");
	r = 32;
	L = 2048;
	KILen = asc2hex(KI, "AF74442C5E36D147059EC918A7AFECECB726D485350E36571A8F65F7F60717D0");
	IVLen = asc2hex(IV, "D85C6C186E902C026D9550353363C57EAC496CC17280653638068DD168A94502");
	LabelLen = asc2hex(Label, "0B62769FEAE5D21FF2765C08DDFE2AAA0F5E690EBE03A32A56BB3D561CC74404113169AB196049045CE9F279EDA8A3DBAA10D45363BF769B3E557C6D");
	ContextLen = asc2hex(Context, "59879A3CB26F4D2344261B1B73951C70AA88B9764304B478A7DB69F1B67D53FE6911D114B5C52AEEB362CFCAFF23E1D55EC7F3E4A3E51164D3800194");
	KOLen = asc2hex(right_KO, "AAA9715FBC437992BF47B0E4C3AE1FA1FFF184FD6526D6245B21B3BF7D8A29839EA0828828EC02C97F59DB863BD28B44EFD34E87C1C19A6E2789C471F02192A73FD87FE379A48C251F15982B2B79FD242B47327F3B7E9360BD79D7E7EA0F4CD0058028F2B32A22755B77F856A7A3E58ABF311A49088D308F88B893BEA87D964EE1F4034D202E7DD068E625A3F7CD03719D1DE787B358F4702CB265BF2FF356C56DCEAEF25D399FF4BB0AFCBEFB4D7F82C12E3E1C050E620420B47B3EEDC709C58A5BE762DE462A1D2ABDB4AFA3563D20FB7BC110B1BFB52814F2557EC4A872ACBE9BB850BF05F476BBC8F2A98F6BAD3FF542FC81B435951CB25E7CD90EEFFD86");

	kbkdf_hmac_feedback_mode(KI, KILen, r, L, Label, LabelLen, Context, ContextLen, IV, IVLen, KO);

	assert(memcmp(KO, right_KO, KOLen) == 0);

	printf("r=32, L=528 \n");
	r = 32;
	L = 528;
	KILen = asc2hex(KI, "08CC172710368ED8F9CB216B9C100FB3CF917DCF887BBD5B4666CFE3AC73289D");
	IVLen = asc2hex(IV, "6F97B357733616AE31F436815CC8FDA5C4525BDA7A6E8AFE35099781F4331E19");
	LabelLen = asc2hex(Label, "E57655B786664BB90A7A7261FE1A5C862CF9C289C0A5CA8BA95D89DD4222C7B83210032F91EFB7614C06DEF3CA2FB2BECF31BAC4A14904696A0AB0E0");
	ContextLen = asc2hex(Context, "DE68AEE31D0FC7A7DBF9E20FBE3F8020072F8AB575A04C736682C10040B911700F2C58007018A907ADAB532929CE62CEFF4269D2E6EE7F7F587788B8");
	KOLen = asc2hex(right_KO, "B2F9DC46B7B3C99082189592E332D9DA3ACCF7DDF8B64A8589CFE4266C34275147DB20460A2DFE004891B23C61D7DD98C56AB70CDC3CC6826E2AE7A81919935FEEB6");

	kbkdf_hmac_feedback_mode(KI, KILen, r, L, Label, LabelLen, Context, ContextLen, IV, IVLen, KO);

	assert(memcmp(KO, right_KO, KOLen) == 0);

	printf("r=32, L=2064 \n");
	r = 32;
	L = 2064;
	KILen = asc2hex(KI, "FA286AF068173AEC73384B9A0AD39995A88617957ADDF39FC0231C7975770261");
	IVLen = asc2hex(IV, "32229DFE5027B0974D1C4F8370399FE1B0AFDD89D33AA142D3FA6435857F40A1");
	LabelLen = asc2hex(Label, "7C23F8D12C9C384B4BD11E4B7DEDF86F2FB250B4C31126A1EEF77CC25F691858A2D3854F439D5B703600C0D876182FA9ED3A78FF94870826DBC16B0A");
	ContextLen = asc2hex(Context, "4B5E0FEE6ADB4B61DF539F6ED6503E14A6E1C9F6B1ED5E528CC6D137610139F39186AFCB9DE352F046E68FAEF36A9FE5547150BD45730996F5F6083E");
	KOLen = asc2hex(right_KO, "A9D9B8812A018C48142074A6EFA93FFEB97F77A78C794ADB123041176C1F4C7CB23F42384009E187E42818EA1EE969B9ECEF2020EE7CAED4D7D15488DD19E484E081F1047C19977AD7884E3698B0B093166EC34D0013F812B45B1B2B4E2B9B90190D36C21438D80C9DF392D088B0780923B091A21068091F431A58B0FBB67FA331313A7A8A9C9E6F9C114F2D7850A998A2AC3C4357D7C37B72F94A3FE885EB3F3145075A467FEFBCEBB9458308A0F44B34D40D9511F0D5E2CFD183ED129EDA3CC4CCBB8A1D63C4F32F7912819BB56DA65574D288178AB2049619D7E4585DD06FDD9B34241AC9333BC37AE7C26B827124E328D72A1FF1EEB74453C4828F212E78CD63");

	kbkdf_hmac_feedback_mode(KI, KILen, r, L, Label, LabelLen, Context, ContextLen, IV, IVLen, KO);

	assert(memcmp(KO, right_KO, KOLen) == 0);

	// with counter, without IV
	printf("r=8, L=512, without IV\n");
	r = 8;
	L = 512;
	KILen = asc2hex(KI, "0A1F0F67D942396A8656EDC747CE9BB9BBD78EF415EC29DA7CA470F1B2CFCA95");
	IVLen = asc2hex(IV, "");
	LabelLen = asc2hex(Label, "F4C204EA22EF9A1520B932AC7C866A6A5115D3286B123D08ABE736F4ADD6CD47A9449CC9975805E197C5BB068FE4847716063E2C9108200C9B284360");
	ContextLen = asc2hex(Context, "AB166188F04FDCEC80A60236B2238FBFC8117346D253D6E8CFF75A4C140EA01FF2BA0DC09388CE3C2500197C3A7BB6BD6F35BF414CA3A4446C077132");
	KOLen = asc2hex(right_KO, "C1C886F0EA1DFB057F2224760B870A68F306470C26C5B0CAB0EB89A2A56B7B7AE43E05303F76DF35F2DAB1CBC80ADDA24084ED57486E35A94E30EFEF53EC1EF4");

	kbkdf_hmac_feedback_mode(KI, KILen, r, L, Label, LabelLen, Context, ContextLen, IV, IVLen, KO);

	assert(memcmp(KO, right_KO, KOLen) == 0);

	// no counter, with IV
	printf("r=0, L=2048 \n");
	r = 0;
	L = 2048;
	KILen = asc2hex(KI, "E77355C8156F0FD778DA52BFF121AE5F2F44EAF4D2754946D0E10D1F18CE3A01");
	IVLen = asc2hex(IV, "76E69C18B7D20B6E0D0BEE5EB5EDFE4BD60E4D92ADCD86BCE72E76F94EE5CBCA");
	LabelLen = asc2hex(Label, "A8B01CFDDCEA2ADE575E66ACAE59B34A85036C37AFEEA9C097F0BE74DE2E05D9457ADE5DCEDFF38F1E79C18F268A54C302CB51CC21003AB9A7CFEE7A");
	ContextLen = asc2hex(Context, "0FD26F9715EBE822D3D8EFEA2A0707F163AB6920160F043A4B2AC20FE0750DF22BF9926CDFAC443234FDA45542AE40B9AEE27AC889778B677595C829");
	KOLen = asc2hex(right_KO, "6845C6B89D55608B98C1089A52215C76DA60B680684E143598588DE02554A7C255EB46A386462C9E3F55CEA5EC32F7E84050BBA5BB643CC72D4C2E0224AF28152D4103FF5EE5EAED9D9D97FC8442AD8AED9FC6F9BC2B0BF4AE2455DC3757F2E9A3F9E2244A2FDEEEC3B7CC90E947ACE235123C9B04C98C07226D424682CDA8B1FD80FAE967C759319F50DD5306BC7B89124683E5415A0DD2924132385134A179CB146925F85FD16A92220AB9D85AF91F216BF8F03C98E112AF7497ACC898FCA322FF35AA17BA7BE3B31EFD0BFCA83C95AA406950A64F7678E2E1A7443F7A12B185A02EA6DE83B2B1A3EBAE7C5DCEB88BAC91F08E4522D8D4CBACC11FF26D17A0");

	kbkdf_hmac_feedback_mode(KI, KILen, r, L, Label, LabelLen, Context, ContextLen, IV, IVLen, KO);

	assert(memcmp(KO, right_KO, KOLen) == 0);

	// no counter, without IV
	printf("r=0, L=2064, without IV\n");
	r = 0;
	L = 2064;
	KILen = asc2hex(KI, "FBA01828800C1D78AE6D7E0C0E31BFE5F3765534162067127D28D571A1367A53");
	IVLen = asc2hex(IV, "");
	LabelLen = asc2hex(Label, "CF73AE3ACF980FDFC44C822653AC7452072B6675F49CA82B9B8D64880ED7DF4F5573FC650F8F02855CE19E34FB3C2CF8B06132C5E9172DB8A07E9108");
	ContextLen = asc2hex(Context, "83A00B39534909928A197CD240D7DC1F4F086D3FB6C0C20A3BB97F1F55A263D748B98577929CDDAA865C072E37D444CD9739C28FE0F21D2E33A925CA");
	KOLen = asc2hex(right_KO, "33055C71835AEB3F309D03AE0F99387FA67E01BE561157DD611F50BADA98C47D2A16FAB6CEF2A55671EA742553461DEC012427E645A9B963226330CF3E76FABF46C83B4F623987030794423FBA29156FE6C10E004F04329B81BAA7134B6A372E3CACA5C7F6AE09DB0F35CA94BA5BCF0484CA1994D39EFDCA682D6EC0FA8DCF7D973BFCCCB23712F75DF167850A2A8BBB70F758FD1859A3DF0C9F955CB0976DA1E6EC557C66985728B820CD1FBFC6E3CB71559CDF7CFA54079011177A224C39864E94635308C67A799DBD962C4D5236DF45EAC56314CDBA4F9080E9107D577577972273122A9F8A6DDBB2603C2FB283C277F56722749A979743F4046668E667FDBE10");

	kbkdf_hmac_feedback_mode(KI, KILen, r, L, Label, LabelLen, Context, ContextLen, IV, IVLen, KO);

	assert(memcmp(KO, right_KO, KOLen) == 0);
}

//KDF-DP(use CTR)(HMAC-SHA256)
void test_kbkdf_hmac_dp()
{
	uint8_t KI[1024] = { 0, }, Label[1024] = { 0, }, Context[1024] = { 0, }, KO[1024] = { 0, }, right_KO[1024] = { 0, };
	uint32_t KILen = 0, r = 0, L = 0, LabelLen = 0, ContextLen = 0, KOLen = 0;

	printf("KBKDF-HMAC-SHA256-DOUBLEPIPELINE\n");
	printf("r=8, L=512 \n");
	r = 8;
	L = 512;
	KILen = asc2hex(KI, "133D114B66EE3D4737720B127900A3C23C783658D2F73FF030A8093B96DD712F");
	LabelLen = asc2hex(Label, "735EEDFD8300CD443A7AC18465759CD50FE257D9A19059EF4EFEF5A9AE6E3581A93AD6C7976B93DEA588A7A87BAC8D3F1CDB0AE60D966D3FB9AD16BE");
	ContextLen = asc2hex(Context, "1455355D7F7AD491EC57187D4243C36603CEFE682C0C56675C310448395E71600FBBF92CBBC6EF43C8EBE28AD7541FA7440277B8061D4344D788A571");
	KOLen = asc2hex(right_KO, "B01F7AF284F6F1BF749041BEBF7447C28D8224DB7DC956848EF04923079A610E4BC39DEAE7F35D8B7F955A45BF3FE1A47B81101F784F72288BC3938BAEFF19AB");

	kbkdf_hmac_doublepipeline_mode(KI, KILen, r, L, Label, LabelLen, Context, ContextLen, KO);

	assert(memcmp(KO, right_KO, KOLen) == 0);

	printf("r=8, L=2048 \n");
	r = 8;
	L = 2048;
	KILen = asc2hex(KI, "2633A14C5B2B355B0DB7E589039647AA0F5F632E3615025011FB299173A9E065");
	LabelLen = asc2hex(Label, "4D60372CCE9B8B63CEE6061C6CF365ABF6EBFEA30A020101FB4EFEA676D9A70B66F5D83014CFD4D59347D2ED5BFFB85034B226B056C8B6CECE2782ED");
	ContextLen = asc2hex(Context, "234BE7873A99894077F09718258251E418E2C7FF905DE33D618EA920512DBE4FC228274391F554443D265D944C3E8BEAEAC31A21D4943D32747D6360");
	KOLen = asc2hex(right_KO, "AE61162CC47F75A2EA73318B4511E9C2FD695857B721C34E1906ED274CD249A5AC40DE50C2564CA9E286C83BCC294CC3B5C0B2A563425B87367B6BCB41048829D9B08DB9940B886FD569D93FA10450BA442B405BC23A0709926182D7A32860291E7371EE3929878CF6BC53EDA62893997641F8073E93A9E61064EE1DA4A33DF010387F4E1A4BE7CF8640B79AE30263D77716CE01B93CA1CF384A32C180BFC95885E3FA7B41EF03F64602FC2274E559B9BC3B9586ACC7C273D621CA9E7845CA9D03BC1D791B4C5177F41F861F933C4804401DC4F7807E96AB756B5FB59D842FF3E8B08BFBE9B4A79ACA2D6CFDC1044E0B7DFE08EAF5823E43E5CF37E173E89A57");

	kbkdf_hmac_doublepipeline_mode(KI, KILen, r, L, Label, LabelLen, Context, ContextLen, KO);

	assert(memcmp(KO, right_KO, KOLen) == 0);

	printf("r=8, L=560 \n");
	r = 8;
	L = 560;
	KILen = asc2hex(KI, "FDAD31987CB3D7BC0C5349B28612C64EBF7F73ADB0C4A26BD47A5316D2C2FBE3");
	LabelLen = asc2hex(Label, "5C9185A0574B97EA3C9416A0BE63EC98AD5709901A4FA767BC35D38D921A29B8CA88DFD8E213054E0D320A58D84D83D00D172817D71E1F4C28A17EC1");
	ContextLen = asc2hex(Context, "58A10BAF0F3A46286434A94E46D62EC31BFA1260A867D82A315A9281E1665C9B6C7E2931F251C27827D60B53B12788C7D19221AF46ED22B16E2B8670");
	KOLen = asc2hex(right_KO, "F7E157F56C58947735806F7B07AD9B0ABAD2C52A216B15D1AD4B03783B2AFDEBB868599B8B521EC07BECB91C06F160EA92423CAB7540193F7E8EB0CE01DB4D09617A3A7DD25F");

	kbkdf_hmac_doublepipeline_mode(KI, KILen, r, L, Label, LabelLen, Context, ContextLen, KO);

	assert(memcmp(KO, right_KO, KOLen) == 0);

	printf("r=8, L=2400 \n");
	r = 8;
	L = 2400;
	KILen = asc2hex(KI, "1F1882F48063951E1A9256311831F0409305E458B59F4DB31F31682E89A153FD");
	LabelLen = asc2hex(Label, "A8DC159E556DDF0BEB4E9234F1FD80ACF9D377A3C792FC14B63DD43F582CC95A5D5FAA84B61394FAFA93708D0851BD54EE35909E0935D82A6E26E79B");
	ContextLen = asc2hex(Context, "89D12E26044A488EEA7D3B520D0AFA25A5532E9E39D23531C3B16B5E0F94A92864BA0CC96644F8A43BD45C7BED5A37E20F2B5BF3A45471443C2D3D16");
	KOLen = asc2hex(right_KO, "5D42ECD5C939F2A33C8C990F162E0A04B873B695609CC522B1FDBD2556200C369EC22CBD9845CD80423A484FDF9FA58ED99548802A1B4EB88B0C41DCAF0D629DD5C41574359E4539DC320D4B74B78D665C5FD1F3C8D62A2466A65320B42D76AAE9DFB001C90901BC9AC0D7110FF155CB4E81F2DB1FF6FEB3C0B1E2D285C4821F2A262C74229D500F0EF6241D01CF47FB7CDE13DBD678348D547CFFB8B3D07E9D0920718178149CB41536CFE6D43438798596E3C49FCB1A741AB25FF5EB7D3509F7A2C1CA6F452722C6E7C327CE22287B981889F0507A2DED28D96F7B605062F8B92B0826D4B51FB85D16DF0FBC66499A4E7B4AEF1AE8AD22A38895BF480BB45E599D5B0A4D26C87EFD02D0D738D89701DAB05946A2B9F30BD0C943D6ED10E534EE059AA6D4FE78B067110724");

	kbkdf_hmac_doublepipeline_mode(KI, KILen, r, L, Label, LabelLen, Context, ContextLen, KO);

	assert(memcmp(KO, right_KO, KOLen) == 0);

	/******************************************************/

	printf("r=16, L=512 \n");
	r = 16;
	L = 512;
	KILen = asc2hex(KI, "521E92625E551C735EFE6BE910EBD554115A75F2FE8173DBD96A857CAF01B646");
	LabelLen = asc2hex(Label, "786C67A73F9A933A831F573BDC3FB13DE248881F4A26EC3C5231A0E26049D506E525393588E830CE81F5616F420575AD5D771B08A2E7501D8701DD1E");
	ContextLen = asc2hex(Context, "CE97218061F210F381667C971F29946D8A66AA0C4B8C39954DEC26E8428346184114211DB47BF5C9713DFEFE2763F51DFC89D7C17432E7AE955EF604");
	KOLen = asc2hex(right_KO, "37D2299D7F04E2E392D9EB480BD7CE485FBC0757C305B62F30327EFA5640DAACA02D44298EB00EE3362895B374DABB115458D311A90C77435C1447B4A9531001");

	kbkdf_hmac_doublepipeline_mode(KI, KILen, r, L, Label, LabelLen, Context, ContextLen, KO);

	assert(memcmp(KO, right_KO, KOLen) == 0);

	printf("r=16, L=2048 \n");
	r = 16;
	L = 2048;
	KILen = asc2hex(KI, "9EA9A0244DE45BEE3F6227FC067EC29D012A267E8086C2D72AB10BE29CDE3391");
	LabelLen = asc2hex(Label, "53AB3880CCAF2129E952855797E24CDDAEE3B98719A6A951361D15D77FEDDE0D6BC5CA308FEEC9FC09247E201EA5FAEF2287CB58984E35189BBEBF2E");
	ContextLen = asc2hex(Context, "7DEEF28FAD9E5D1CDECADCD165801A3FE3EE553C25BF61D948A8F094213D10CFDC0AF581E2DFF92C016BE10FC70C629C2EE6E42C7F3385F270D9612D");
	KOLen = asc2hex(right_KO, "12E1C83E0C5C90178EE6CCAEC256D204536E0DF9265D916F38B3E24E887E37466151D63E823BA10BBAF4DFD16311F3B7B046F86C17DCE61C50CCB3BF6A51A84E385EF98184C07CD80A4A78D5A3F5496D85C982905A612F5042A19736C3A80ADD33DE4A6007FE015D37FCFC898E5293F70446FE5E8CE9FF8DEC9E9A689D1796AB974D7465D38A8F4050008224108D00F3E715A46C19FE16EF1A34283C14C75F2677BFCF939BD10FC29D778E2C816B398809791D31D12E41330D4F4C0F8C0B6EA9E00CCFB3CE07EE577E0759C8DCF1C2598F0E25F2CA87FB6DC3439F315E99CFA4C228B65372CA68AD493E6F9DD25A1B8404650600E5E8DDC2AC08C9BBDA626D84");

	kbkdf_hmac_doublepipeline_mode(KI, KILen, r, L, Label, LabelLen, Context, ContextLen, KO);

	assert(memcmp(KO, right_KO, KOLen) == 0);

	printf("r=16, L=560 \n");
	r = 16;
	L = 560;
	KILen = asc2hex(KI, "4AE62CBFC4AB820264CA68CDD063486E6960343F74072AD878CF9783E67319F1");
	LabelLen = asc2hex(Label, "FF46892BF3C639CA46737A6B78E2625EE50DCC9EEAED9F06494B54C1CFD3B203346ADCF642C18EF8392AA40373ABDC6C4451DCD124C7774D10272CED");
	ContextLen = asc2hex(Context, "2D10EF68AFF92D0AF9C50AF20597ED7D07E73E024DD66EC06ABE3814930E27F049555988399C824E60F9332172615DC17DBE1187C941895304FA6CC5");
	KOLen = asc2hex(right_KO, "B8BB5ECECA0E2E53846A941E00DDFF78DD81C7E5738F4C4D0C5D64AE021AB5FBB68C8AA5C8EE4AB8E59F06B6838D962CF36E6902AD4D10D079BF4130E494ED7BD9D9C3576420");

	kbkdf_hmac_doublepipeline_mode(KI, KILen, r, L, Label, LabelLen, Context, ContextLen, KO);

	assert(memcmp(KO, right_KO, KOLen) == 0);

	printf("r=16, L=2400 \n");
	r = 16;
	L = 2400;
	KILen = asc2hex(KI, "DD3EF4F579860063B4804E008655355A922721B84FA1DA5369D209C3653BF8B8");
	LabelLen = asc2hex(Label, "852699EAEB3ACA53004DD79B177940D44E72BD67B516804EB346BA84A5F560BAC77E2F4C583BEE73F953F3BC57D3E8B90901CFF6BCED442E8D4802BF");
	ContextLen = asc2hex(Context, "B679A95C6DEEBF0209B0F42D673BAA4B8C8CB4718B7B5E4DA94BAE5CC080EA5CE1F05A053D1D4FF446C265E811AC0430FFCB2D649C897354C75A473E");
	KOLen = asc2hex(right_KO, "5A68221625063C79594B9EFCD26D4E0850E9D066F630B40EFA3707FE5CF1F364ED94935E5B887985CF3A9DEF6770A26694E111062A3820C3045527FBCC99155D8F33CF4FAF8AD012E10CF4BF6843D74D237C3E0FD64B26DF7FA3EE5469A3EA52DD67676B00FC8937E11E83B34524FFF1A9799B118DEE7DB4E8796F7115A799549BC78EC809F4CCAE092AA2D16A4D8687795ABE4DABE07ADDA94D16BA75432ECC23ECC0E41973044777D1F07FE3C1498CF155802386960FBC10D8CD3AD97E8CD3BE36CC1D22D32061405471259B2DD56D48F261950C565CA58CDAE050DE37E8EAAFF6F3178FCE0B4F5E59CC99232B1821DBA6E05764F804146D5846E7F1DE429F34F3F95954581485BF596A09F1A1D392CDD478A78FAADE680E897B2648472FCF0BE1157814B17D5A05462937");

	kbkdf_hmac_doublepipeline_mode(KI, KILen, r, L, Label, LabelLen, Context, ContextLen, KO);

	assert(memcmp(KO, right_KO, KOLen) == 0);

	/*************************************************************/

	printf("r=24, L=512 \n");
	r = 24;
	L = 512;
	KILen = asc2hex(KI, "1D5DF7C8658E8303571038787E51983301E9A9ADC92E40FBE6027F452FF09D7A");
	LabelLen = asc2hex(Label, "2978E5422BA60234BFEA794A4A237791F0FDCD25B27D395DD9DAE743988F3747EDAEC134C87797626F29C92E21182FA7F900628A16990C71F96B6247");
	ContextLen = asc2hex(Context, "2EE4EEFF2FA892858528CAF53076310C495847DCE69B71C33EA9419D0E5EF8393B18490AB80D601FAAE22355CA79B8CC0B0A47977E7501B872D6614B");
	KOLen = asc2hex(right_KO, "C099FBF87EF166B3B9468E7C037D0C1580AA7B0BFDD12AB7472243EA19BF640DE1B6A5040B01E13C574CDF4F19B5F34CD8BD6E449DE0C1E7DC1868ADB4023543");

	kbkdf_hmac_doublepipeline_mode(KI, KILen, r, L, Label, LabelLen, Context, ContextLen, KO);

	assert(memcmp(KO, right_KO, KOLen) == 0);

	printf("r=24, L=2048 \n");
	r = 24;
	L = 2048;
	KILen = asc2hex(KI, "122E757DBE20FB15B344C5574F90C00D7D53CD1FDAC90CC116EC5AEB9C8E1809");
	LabelLen = asc2hex(Label, "75A52FF569E650226895811A299BD52A11D97A5B56BCF9A56411BA60801BC7FBABE3D1F0C9D078F70277C77B69B4FE4ADBFA95902AE77D067B1CA967");
	ContextLen = asc2hex(Context, "ED4BCD247C9166582407FAFE4994A1625605C4D5A55F25A59F731F4C24B430E82D46B4EBAF57F314C3B25E9E059116B739B3AE3335AF3282FB8868DF");
	KOLen = asc2hex(right_KO, "D4694C5157FE9FC8F0338E97447FEB63AB918A30E893F06E703C92CD41CF69B551F0228A44D226F9B8895D09261824951D4F5F0DD2DE9BBD97AF89704B3BFAAA4950C1C0FB9A33275C74742C0515158B73D225EEC0B8071905698B90379D4D14E51093B2EDA76D871F60DE092F48745F849A3EDE49930F557DC5E291CAC3CF6BD155E26DD3472AEE82092A4D5602E35B5722E42C8235401FC837BFB0AC5B51BBC82FDF5564D0AF72C1CA59921796AE01EA60239FDC2BD3D44DFC56307A62B989C1F300560DE0DC96EE95DA9457F45C062869893D5CC33B888CE63831211708AD11A485FB399730D01D004C5D5418286633C60CE3B2095B52DE7718CCFF247EA5");

	kbkdf_hmac_doublepipeline_mode(KI, KILen, r, L, Label, LabelLen, Context, ContextLen, KO);

	assert(memcmp(KO, right_KO, KOLen) == 0);

	printf("r=24, L=560 \n");
	r = 24;
	L = 560;
	KILen = asc2hex(KI, "02DCEC96FAD6960D6F27D400D18D3C3B0F4ECB52B7CD2CDA5E5B37D8424FB97A");
	LabelLen = asc2hex(Label, "2E5973059E13650F24D94CEE0ADB6970397084CD59AE31D93A37527E7355DD6A494ADF05D2E1C1A65A49CA060523E6F5B6DAA64B303387227B257742");
	ContextLen = asc2hex(Context, "8AEA95DD1A56397DDD68343AD81F5930098E3C304E3339B68285B81BE9CCB00CCE356A3B6A26885408CF45336702FE546044F28BC82446F598CB4C2E");
	KOLen = asc2hex(right_KO, "DAF9437C694AFD1DF715435EDD09E6E1B1C39BD21B525061B09D7C4ED3BFA9666B6E2B1525889498327B6AE169BB6D8B70243FCF56D22260AA1766959F1BE7EB41A0BCBAB538");

	kbkdf_hmac_doublepipeline_mode(KI, KILen, r, L, Label, LabelLen, Context, ContextLen, KO);

	assert(memcmp(KO, right_KO, KOLen) == 0);

	printf("r=24, L=2400 \n");
	r = 24;
	L = 2400;
	KILen = asc2hex(KI, "76D21BD5D28BC49D730584171B04DB4FFC0723C9D8D5D0B86759F770F9AF0D1E");
	LabelLen = asc2hex(Label, "5C7FF2B7008A2D2E59827AEA851F82772F6FE97CB36E8DED82D60D81C93889674D4CA9359986E1215CE9F3730D20B53AD0CB143E9D1759379F91AB3C");
	ContextLen = asc2hex(Context, "DA3CD57E11E04A36E7A666DC44E2F79AFA30FC00A9C2ADF9E0F8BBFE8431D88976E27ACD70E5DCA4301346C9D9148F479676E03180FDBA94C23A3BAA");
	KOLen = asc2hex(right_KO, "F441B4CE8FB854D50EF53C2058D3013B3B756CA89907AECAB2444596F70A4E565B48EE458D553C3511ADE0E7608275D2DCCF52AA0CF0DA4E5EA9BFD3B6A93EF9D5F92A2A4D0B83D372F04966DAB7EE984F8E08A41747E085F4283BC1ABFC5EBF4531D82A880DE3A56C1D0BC48E49422850CC8085D1D40470AC1D97B4B0147C29B56A3FBC26E5E6F1BCD59203DB4CD735E0E37DA842A9B950423454FC10B2EA2A1B25BD2E641E73826EDAAC6AE85E35DBA9E4D3E6784EB4AA542C806A59679FDBD33568575A3FB5D6534C8BC29682AC9600B14993A8819CE6DDAD880F0B3D8DC9B0A8F1F1612346DAC2719C13B9D3ECB3E3BEAD35CD9D5EF7AD3CFDB066160F7838529EB77278280F05797568C4FCB209776C36F8503959B8345B8B907A30FBA4013E8A45A3B8875D4CDAFA3E");

	kbkdf_hmac_doublepipeline_mode(KI, KILen, r, L, Label, LabelLen, Context, ContextLen, KO);

	assert(memcmp(KO, right_KO, KOLen) == 0);

	/**********************************************/

	printf("r=32, L=512 \n");
	r = 32;
	L = 512;
	KILen = asc2hex(KI, "33BA023F3C5A34B8E468337F83F0AC1ECCE79347F4BD670E1731B756D769E589");
	LabelLen = asc2hex(Label, "46422A8D06E5DAF3AE9BE97170E2AF92F9C0E8AC9957FF13A4BA8C8C18FF1B047F952F8217D8865B31E39FA5D7A57AEDB1389F2D2A6D61F8CEAC64F8");
	ContextLen = asc2hex(Context, "F6FB5D9AA85C1908B95CC15834E95C0200649598BCF7BEB1EE2916275DAF4782BB8533B3873EF0063299115281542872324589F9E2A650222EB1A506");
	KOLen = asc2hex(right_KO, "16E093DF9F1F492B8C19AC63D0296BCD8AA9815650DBD88458FF374D92460F05E988953698305A74042BCD8190938614A971B7BF6D72303BA7ECBF4D07437B73");

	kbkdf_hmac_doublepipeline_mode(KI, KILen, r, L, Label, LabelLen, Context, ContextLen, KO);

	assert(memcmp(KO, right_KO, KOLen) == 0);

	printf("r=32, L=2048 \n");
	r = 32;
	L = 2048;
	KILen = asc2hex(KI, "4081DF166E9ED4912B1B815AA08CFEB9459A1AD0029E9FD0956FD76C33774E8E");
	LabelLen = asc2hex(Label, "720DDA4966FFD9100A6DBA25E2DEBF53DF8D00E08304B4BE45ECAC0137242096E610AE318234A0873F016EBEFAEE832120CB4419CC524F582F000058");
	ContextLen = asc2hex(Context, "35233A04653364B50A65B15F907EA50D30E5D58AD0FDEE6124B1F8081A51DC59759C2441B71E03BC45BC9501C68D67F9CCEB3AF6B6CA04A2D5493836");
	KOLen = asc2hex(right_KO, "37A50C8E0B5306E12E415FBE48F8C4A3CB0FA3E2795D2747FE3B535A3E5D4C01A668413787FCF92ADFA8F2D13E5CC2DD5A937289DC21CED9CD190B6461F0E6B80B3F421202EF6C872DD4C41531BAF0C28100A3F50586077AC670130CE52785A9B130D067A7790CBDCFDFAE490BEA41F6A30D08A88C007DAC96BC47CCC1E77AA23BE02BF01E40BB0DFCA5F601632C4FEB2AE81F4A5F1D0F7E0967B0FC520E8A933A9BE35B42D820AFA59E0B530CF4097C74538F3F25C45D383506608C1928A9EA63F4EB9A9D2A20835533F003345B3C532038BA4A5D7EEC94CFB484DDE7828CF11C9250BC30624341CA8F4E8B6724BDCCE9B2066664AE7C042BAF7164B1F5EC6A");

	kbkdf_hmac_doublepipeline_mode(KI, KILen, r, L, Label, LabelLen, Context, ContextLen, KO);

	assert(memcmp(KO, right_KO, KOLen) == 0);

	printf("r=32, L=560 \n");
	r = 32;
	L = 560;
	KILen = asc2hex(KI, "E65031DDE1F2D49CEE2A4D0C4A5260736F0BF7A539D5673048DDF5D6A5159940");
	LabelLen = asc2hex(Label, "A88A02F019F3D97895854AE9330FC18F6842F1DB28501BA14EBA8D843E6269AEC9E8A7C451335D182D4E3E214E76612923714546BB21118B2A58207F");
	ContextLen = asc2hex(Context, "2DEEBCCE11112A3FD0DDE8E67E2C329BE3B0CAAB6A3FF9CD3A6DD157A260B6B1BAE01D0A47AE924BE01700494FC82D3F3AE4847B03541757EC5FE46B");
	KOLen = asc2hex(right_KO, "411C37FE279D1431AAF8A72713094F8C39E7BD479AA2EE1DCE9420B743C7BF36852AA05119912E003AAA6BE434E021FCB0529115ED6F63D4E2329E902F537D99CDA69729BDEC");

	kbkdf_hmac_doublepipeline_mode(KI, KILen, r, L, Label, LabelLen, Context, ContextLen, KO);

	assert(memcmp(KO, right_KO, KOLen) == 0);

	printf("r=32, L=2400 \n");
	r = 32;
	L = 2400;
	KILen = asc2hex(KI, "AA94B8564A32A28B14E0B63797FEA2E19165AA4A10FCF0A1D786F2F603BE54F1");
	LabelLen = asc2hex(Label, "EFA6E0C4541CCB5EB5AE39E1FAAF04575B8AB9A17F57E4AFE5AC8EF784B6031FAE88D9FD3AB22DC2E2163072EAF7E39803531E376E73D70364C0A1D1");
	ContextLen = asc2hex(Context, "B6D8734DB1E1ABEB441E522065BFA2D1B0FEC50C5167E0F6257750041C69346EE24D2BE1BE5A5F75BA85C2DE045397E694EB351B0F6F07C4EB8CD81A");
	KOLen = asc2hex(right_KO, "4E573B044760C0AD9B1D77D39ABE1F9188BE630DA06DA791EC793496D9DDDA6465F690067D756EA7D21E90899AB728C66A275556262C3C59129A7E50BA4107B366469DEC019445C4024C2CE30456994C6C59BB9DA20EFEA49E6B0901869327934565943B7C4FC48B05DC99649C36F7DA12B70B9092C3F4694F660AED7C3CF56D3800216FEC9CCC2DFA81719CF63C281BCC249F907AE47DF1769C9694DECA561E9C2D26A888305D15D02FA96C8DA8F177B62001D2BA55DF36EB0CBDC6E767900DC333E314308FE95A666F29C2536FFBA1CE95041041BE812CFF50188E21C76F45D395A92B5A3591CF9A59EC883E5539E8310F0A87B17FC61B158796D2AC63EDA481E18874341C04913961E4DA0A2E9E28C0E11D04C9F8E39CF437763EE49BAF550E3C258A74B20A873EF57530");

	kbkdf_hmac_doublepipeline_mode(KI, KILen, r, L, Label, LabelLen, Context, ContextLen, KO);

	assert(memcmp(KO, right_KO, KOLen) == 0);

	printf("r=0, L=512 \n");
	r = 0;
	L = 512;
	KILen = asc2hex(KI, "133D114B66EE3D4737720B127900A3C23C783658D2F73FF030A8093B96DD712F");
	LabelLen = asc2hex(Label, "735EEDFD8300CD443A7AC18465759CD50FE257D9A19059EF4EFEF5A9AE6E3581A93AD6C7976B93DEA588A7A87BAC8D3F1CDB0AE60D966D3FB9AD16BE");
	ContextLen = asc2hex(Context, "1455355D7F7AD491EC57187D4243C36603CEFE682C0C56675C310448395E71600FBBF92CBBC6EF43C8EBE28AD7541FA7440277B8061D4344D788A571");
	KOLen = asc2hex(right_KO, "B7CCAC899420A9FCD29FA73613D1E7E91BAD588E4F0CCC7712A3A3569074E148A382B6C8E13FCF5ABD5D6E52279CC6D2BC54074815E0F5038DF47D69D66BF213");

	kbkdf_hmac_doublepipeline_mode(KI, KILen, r, L, Label, LabelLen, Context, ContextLen, KO);

	assert(memcmp(KO, right_KO, KOLen) == 0);
}

//KDF-CTR(SEED-CMAC)
void test_kbkdf_cmac_ctr()
{
	uint8_t KI[1024] = { 0, }, Label[1024] = { 0, }, Context[1024] = { 0, }, KO[1024] = { 0, }, right_KO[1024] = { 0, };
	uint32_t KILen = 0, r = 0, L = 0, LabelLen = 0, ContextLen = 0, KOLen = 0;

	printf("KBKDF-SEED-CMAC-CTR\n");
	printf("r=8, L=128 \n");
	r = 8;
	L = 128;
	KILen = asc2hex(KI, "D87DFE5827D565193EBB71F9D59640AD");
	LabelLen = asc2hex(Label, "98F27D442B7684B96A16C7C9F58A7002ECFE481DF70BD78D8AE6CD5867D7A02664ED77976EF147DACE983B7CABFC5A7DD04D64A9B0C4FC25A7D90C49");
	ContextLen = asc2hex(Context, "83B666AD43EBA7871F636134C8977914F001CD9B0DD41AA55AEA1E0A1FFEF973331BD96CBF54D6BA44B61BEEE07B473ACD8013842AFA34B9FE648364");
	KOLen = asc2hex(right_KO, "4C75ACA0136CF1B4DE72658CCD0A7C44");

	kbkdf_cmac_ctr_mode(KI, KILen, r, L, Label, LabelLen, Context, ContextLen, KO);

	assert(memcmp(KO, right_KO, KOLen) == 0);

	printf("r=8, L=256 \n");
	r = 8;
	L = 256;
	KILen = asc2hex(KI, "FF2C89F49AA4842009C809F78B6408BF");
	LabelLen = asc2hex(Label, "27FA4D22A8B4A5C9E79C422D480F60AA876F29D6B519D6107D97185CAC16B66EF11A7704E07042793D6584977835D2AE74C6D0E28C9651C9D8F2BF36");
	ContextLen = asc2hex(Context, "AC6ABE4F62810CE65AA9AB063E6E43CB8BF1C2774D9845C32A043B73A143C72D9447678B0497D46F1D45299772204671892A77309A4D511F9449DD35");
	KOLen = asc2hex(right_KO, "3EE3D65FD190B3DD4E9BCCC0EA5BB49FEA47F34C4DF5C2B1EBE8CAAB7BAF24BD");

	kbkdf_cmac_ctr_mode(KI, KILen, r, L, Label, LabelLen, Context, ContextLen, KO);

	assert(memcmp(KO, right_KO, KOLen) == 0);

	printf("r=8, L=160 \n");
	r = 8;
	L = 160;
	KILen = asc2hex(KI, "09003383459BB736B305A0475DAEEEC7");
	LabelLen = asc2hex(Label, "E24CCD4077D0BB462C98ED5071E6EFC6D8918C5B1CFAED9D634205CAC0BA2CE6FC9B090A96F8B6FF08F01F0C4C28AB0B9F791FC285E5BF710DD0B6A8");
	ContextLen = asc2hex(Context, "566CB75B5276E538CA20F038A24E81755F04D93BE61FB561864474DA39177B8727ADD94F6C4327721B30B21A8318DD34B163C07D36ED15E02AFF55FF");
	KOLen = asc2hex(right_KO, "B13E628449E305F9DF4C6C3E0EE267E6F8BAC08B");

	kbkdf_cmac_ctr_mode(KI, KILen, r, L, Label, LabelLen, Context, ContextLen, KO);

	assert(memcmp(KO, right_KO, KOLen) == 0);

	printf("r=8, L=320 \n");
	r = 8;
	L = 320;
	KILen = asc2hex(KI, "B4C3A116F45536BD1ADBFC9838AC46C7");
	LabelLen = asc2hex(Label, "C7F2E1EFA3A23DD157B2CE229B86B2961BAB943F7AC7D01597D0D8D60F7DD61003FA937B1BE0978DCA649249D4CFFA580E2EF65A654A7B7E22DAB450");
	ContextLen = asc2hex(Context, "6DF8A8D30FD217D07CA2A46D10E03A0199B5A82716B48E12BEC57D2044615AB15A05033974E03594CECFAE9AB08C8EF4F123032EBAA5250C8C1F1F22");
	KOLen = asc2hex(right_KO, "1762A0C618AD64516663522F0B357B7923D7C9E6619CC5D5C3DC9878768157B26A9E4C34456A9F46");

	kbkdf_cmac_ctr_mode(KI, KILen, r, L, Label, LabelLen, Context, ContextLen, KO);

	assert(memcmp(KO, right_KO, KOLen) == 0);

	/******************************************************/

	printf("r=16, L=128 \n");
	r = 16;
	L = 128;
	KILen = asc2hex(KI, "FC7DB9FEB5A973565BF422DD49D7A6FF");
	LabelLen = asc2hex(Label, "1234B0BF7A45E04BC5D32AD435A87E9CCE46A8515CD97599B76B17EE4657CAACC200B8683CC21A846229A100FE611493BFEE3AFB3C9DFA9136BBC120");
	ContextLen = asc2hex(Context, "1D8424F7D6DEC73DBC487D85E50DB0A2A6BD04BD59DD37A55DDE4C655F4CE81CD848FC09D738A4E601BD4F77D6E6216236A39541237C67F6C882B13E");
	KOLen = asc2hex(right_KO, "085553893F2CC0AA6F9D529627B3CBBF");

	kbkdf_cmac_ctr_mode(KI, KILen, r, L, Label, LabelLen, Context, ContextLen, KO);

	assert(memcmp(KO, right_KO, KOLen) == 0);

	printf("r=16, L=256 \n");
	r = 16;
	L = 256;
	KILen = asc2hex(KI, "1F789ECCD5B125E2D3375646FEE9E4F1");
	LabelLen = asc2hex(Label, "409C9E82891198D5132485D7EB456899AD2C6CA38EC90F8AA07A86C552815DBC36B55F220877B585EBE85223F55A8E00EE04103555F9F28BA45B2048");
	ContextLen = asc2hex(Context, "D6CB014925255A51186A6FA1BDFE6BC9331401BD6C66542B3129140C6740EA7A90B017C1955458B8C2D20C5212CD9870AD5C0BF9AFBBFE2D2B41BF36");
	KOLen = asc2hex(right_KO, "8B317F50A22087819E604B603EC56AD032D2A26CD8E2DCD192840E3B0F82DFAD");

	kbkdf_cmac_ctr_mode(KI, KILen, r, L, Label, LabelLen, Context, ContextLen, KO);

	assert(memcmp(KO, right_KO, KOLen) == 0);

	printf("r=16, L=160 \n");
	r = 16;
	L = 160;
	KILen = asc2hex(KI, "993DB650E0C640821FCF1D4503DA125E");
	LabelLen = asc2hex(Label, "0FF350499C9E9AD01E0EA5DDAA97C48DB566C5851F70158970A82B4B617524809E63AB39CA191C71C38BE9E228703C1E19F7DEDA3EB5578D0BE2573A");
	ContextLen = asc2hex(Context, "42C65489B96E751D5DA3AF22771D2E252EF3F6294D56CAF7477F4CB579E667BAAEB5EAA1E87C759C5E26990BC12C3B4EC30839D7DAED518341B53E2A");
	KOLen = asc2hex(right_KO, "9A26FC03FF9151FA3B9DBC1466F4D25FE1B0DCE7");

	kbkdf_cmac_ctr_mode(KI, KILen, r, L, Label, LabelLen, Context, ContextLen, KO);

	assert(memcmp(KO, right_KO, KOLen) == 0);

	printf("r=16, L=320 \n");
	r = 16;
	L = 320;
	KILen = asc2hex(KI, "2894A79CA481F9971B233D8A45E48846");
	LabelLen = asc2hex(Label, "7B41AC65C1C65BDE033A8FD69F1728B9243DD78A59E63C7782DD4BB1DEEBF47A7492038010FE45698839ECAF439E34AEFC9047FBC46C5EF846BB2AA5");
	ContextLen = asc2hex(Context, "4FAD72B98EC3FDF298CBB2A92E11FEA9C3D4764139F7BE98ECF9A941F127A10FA0104A2B4F3A62636113ECC5802A8D6D269F369B62D90309D976637B");
	KOLen = asc2hex(right_KO, "19B2D23F1FB2796044F91A8DF84AAACA833AA28262906022C63A1A38BEBB15CB7A9441EA98CFABF9");

	kbkdf_cmac_ctr_mode(KI, KILen, r, L, Label, LabelLen, Context, ContextLen, KO);

	assert(memcmp(KO, right_KO, KOLen) == 0);

	/*************************************************************/

	printf("r=24, L=128 \n");
	r = 24;
	L = 128;
	KILen = asc2hex(KI, "C88754012EBBC6C2E6DEBB06F17EDAEA");
	LabelLen = asc2hex(Label, "C2D0D56644A291DE1F9187F3387C6A9F76390981CC86787574426A6878DDE26B770D0B05A6C263CE155D1F39341CCCB295D932E9F3F57D6D748F9F7C");
	ContextLen = asc2hex(Context, "2BF9F01AE16C176015FA2E1741C521855F6F5787ACD195E0ACF01FD16E2C20EA11BB4B1F8756C31E993238E02B32537EC25B55474388FB0FFE5FA4C9");
	KOLen = asc2hex(right_KO, "053778970B7BE5CBB93828CA5AFC2178");

	kbkdf_cmac_ctr_mode(KI, KILen, r, L, Label, LabelLen, Context, ContextLen, KO);

	assert(memcmp(KO, right_KO, KOLen) == 0);

	printf("r=24, L=256 \n");
	r = 24;
	L = 256;
	KILen = asc2hex(KI, "B75EE40FCB8D5BE4DCE8DBEA7464DCCC");
	LabelLen = asc2hex(Label, "6029311FB48B30F20F3D12A620C19D006923007C43E7FEE423404E221B834253A4DAA81C9A3DEE41889E89732664966A201BC234196A68CDF045FAEF");
	ContextLen = asc2hex(Context, "4263A22B30F32939628B178D4B611C2AAFBDAEBB63AEF4E055FDE3C6CC5FA7FAF0EE447F8CDA7D1E135CF5FDE1EC9473C4B42C1BBB445C27FD87B5F7");
	KOLen = asc2hex(right_KO, "373BE5597DB3B409785917A30B6C78D8A6185A130F53BA389270B00CD2AD38EB");

	kbkdf_cmac_ctr_mode(KI, KILen, r, L, Label, LabelLen, Context, ContextLen, KO);

	assert(memcmp(KO, right_KO, KOLen) == 0);

	printf("r=24, L=160 \n");
	r = 24;
	L = 160;
	KILen = asc2hex(KI, "71A4BA99074FAD1F9A6A23A87C8CA4AD");
	LabelLen = asc2hex(Label, "1314669FDC1A6D7BB0A6F69F461F16DCFA069FCCCCE44365AC80FCCFF556AB733745FF55398898A33EE76C8E882E6A581BDF5EAEC32415395807C170");
	ContextLen = asc2hex(Context, "41E59EB03720D68E4B15A36C2B4EB34AA1F8D0DF5C97C0E8F3F86AC127673B326923C88B9C0FB5F31BAAD5FDFE41927C9964909946968D2265488C25");
	KOLen = asc2hex(right_KO, "F0BB831E16E110E26BEBB5A437B979732324BB4B");

	kbkdf_cmac_ctr_mode(KI, KILen, r, L, Label, LabelLen, Context, ContextLen, KO);

	assert(memcmp(KO, right_KO, KOLen) == 0);

	printf("r=24, L=320 \n");
	r = 24;
	L = 320;
	KILen = asc2hex(KI, "B3207DAEB09CF2D2FCCD58F0F431888D");
	LabelLen = asc2hex(Label, "D79B5738CA28BE1A1F7438CFD60E6C7464290C01B494FDD96CECB8A07110F04DADD5758010FB5815D46050F906745C3C42EDAA68BEBCB812893FB9AE");
	ContextLen = asc2hex(Context, "15B83AA8F4FE05B0DF724555FC35ECD561985233D4D41E8BD4FC6AA3DE2F22C2E912ADC5337DD06F3F75CF011E5BD50AEF629581A2473211013C5CB4");
	KOLen = asc2hex(right_KO, "877C0B169B1729D373EFF1BA0A88801B3B2B746E1C1D259266F61303C726D338DB42D724AFD61ACA");

	kbkdf_cmac_ctr_mode(KI, KILen, r, L, Label, LabelLen, Context, ContextLen, KO);

	assert(memcmp(KO, right_KO, KOLen) == 0);

	/**********************************************/

	printf("r=32, L=128 \n");
	r = 32;
	L = 128;
	KILen = asc2hex(KI, "7BDB11A0D24B9E9F21BB7EB30BCC1AAD");
	LabelLen = asc2hex(Label, "E9072B7ACACED7B0B8921C673E47724A2715ACEE8751206200AB07073EA927A1C454AFAFEB3162F82772F7678D6EC018924F8BB3160AC6F9A195E69C");
	ContextLen = asc2hex(Context, "EC540954A3D4D92F69BBB4291DFF0BFC5B57083946EF74988560D78C8CDFE11B1DB408ED0EEF73A34C56176A20A120CFB1EA92D5CB5F3044DE3A9D45");
	KOLen = asc2hex(right_KO, "A5648D1FBA5F06DCD3C8371B48C1E35F");

	kbkdf_cmac_ctr_mode(KI, KILen, r, L, Label, LabelLen, Context, ContextLen, KO);

	assert(memcmp(KO, right_KO, KOLen) == 0);

	printf("r=32, L=256 \n");
	r = 32;
	L = 256;
	KILen = asc2hex(KI, "061F9BFFBC776667641BDA222D15328F");
	LabelLen = asc2hex(Label, "C7E045386A65AD5E1A2928D929C43E1FFD9525A214B4E15F4428AFB3485AA47178CA9233D8012BED54C769C84A952D2D494D261F1929F4CFFBF18D6A");
	ContextLen = asc2hex(Context, "3172E036C12BB9DD7749E50929D696303E2D09B271B16521D3BEE7DF0FE03CEFF2432E052B6B83DF4F2522D820BE78BB0E721AD5FE27AC4E4B5C01B9");
	KOLen = asc2hex(right_KO, "0132C9875A0E79245A19AF6AC40566F7A387DCF18C64A1B0593FC10EAAB67A41");

	kbkdf_cmac_ctr_mode(KI, KILen, r, L, Label, LabelLen, Context, ContextLen, KO);

	assert(memcmp(KO, right_KO, KOLen) == 0);

	printf("r=32, L=160 \n");
	r = 32;
	L = 160;
	KILen = asc2hex(KI, "CF75809EF977404B6418F3AF0805E4F4");
	LabelLen = asc2hex(Label, "2EF04C817785768621A021D486BD26F3E5B05A6E6596B672570BB597BC9DFEFE0781439C248569D5B846E94DABA376FBE471E07F537038B5357E358A");
	ContextLen = asc2hex(Context, "930BD60E0CCD49CBD5B50C56FE215223F753A89D5222D876CAEF0D3C85DB392E9637B44DC63D26B694FDA62E7A9923FF72B50303B92A0BFED3FA7F30");
	KOLen = asc2hex(right_KO, "C949F73AE480A79E28EA580E3CEB52018872FDE7");

	kbkdf_cmac_ctr_mode(KI, KILen, r, L, Label, LabelLen, Context, ContextLen, KO);

	assert(memcmp(KO, right_KO, KOLen) == 0);

	printf("r=32, L=320 \n");
	r = 32;
	L = 320;
	KILen = asc2hex(KI, "96A5658C56E560ADFC1A8B0A87D684DC");
	LabelLen = asc2hex(Label, "1A3F24A7FE09A6C7E9A10B4B81ABBC071CAF72E5CA0F537C953D5EE4072A08C8ED0227BC5B1610D1F01AFC675B90B1431E845EE2927AC60C2CA5A0AC");
	ContextLen = asc2hex(Context, "FE593EDE81C36E4A91D89EB1B98B43C5B1437B3E258CF02AB80C008449BA1C09754A6E475DEBBFF7A935978CCD5DA60C8AAC621FB82FF26644AF4B0D");
	KOLen = asc2hex(right_KO, "7D6C40FD8728ACEB56327F467A75A4F44D3EF0613BE47544429FF03125476598DE7A7E8C0AFD65A7");

	kbkdf_cmac_ctr_mode(KI, KILen, r, L, Label, LabelLen, Context, ContextLen, KO);

	assert(memcmp(KO, right_KO, KOLen) == 0);
}

//KDF-FB(use CTR)(Not allowed Null IV)(SEED-CMAC)
void test_kbkdf_cmac_fb()
{
	uint8_t KI[1024] = { 0, }, IV[1024] = { 0, }, Label[1024] = { 0, }, Context[1024] = { 0, }, KO[1024] = { 0, }, right_KO[1024] = { 0, };
	uint32_t KILen = 0, r = 0, L = 0, IVLen = 0, LabelLen = 0, ContextLen = 0, KOLen = 0;

	printf("KBKDF-SEED-CMAC-FEEDBACK\n");
	printf("r=8, L=512 \n");
	r = 8;
	L = 512;
	KILen = asc2hex(KI, "D87DFE5827D565193EBB71F9D59640AD");
	IVLen = asc2hex(IV, "98F27D442B7684B96A16C7C9F58A7002");
	LabelLen = asc2hex(Label, "ECFE481DF70BD78D8AE6CD5867D7A02664ED77976EF147DACE983B7CABFC5A7DD04D64A9B0C4FC25A7D90C4983B666AD43EBA7871F636134C8977914");
	ContextLen = asc2hex(Context, "F001CD9B0DD41AA55AEA1E0A1FFEF973331BD96CBF54D6BA44B61BEEE07B473ACD8013842AFA34B9FE6483647ABC5B7F7EEE42885F91CCD8E8D1BD31");
	KOLen = asc2hex(right_KO, "6292F72C8D11A9E5E6536FA5A460EFA1B59C12A90CD0C191516F0C5C1D374732A7022850A5613C891F860776B1F39E6F349110A858E33136846B05C80B7D05B3");

	kbkdf_cmac_feedback_mode(KI, KILen, r, L, Label, LabelLen, Context, ContextLen, IV, IVLen, KO);

	assert(memcmp(KO, right_KO, KOLen) == 0);

	printf("r=8, L=2048 \n");
	r = 8;
	L = 2048;
	KILen = asc2hex(KI, "62810CE65AA9AB063E6E43CB8BF1C277");
	IVLen = asc2hex(IV, "4D9845C32A043B73A143C72D9447678B");
	LabelLen = asc2hex(Label, "0497D46F1D45299772204671892A77309A4D511F9449DD3561F1F9EA6B97FA4A5FC59648312E025460E357307BCA3AFFE44DBC9FD44F7F389F641B15");
	ContextLen = asc2hex(Context, "3941BFB3F9711C189E4A7E6690203CB068B8530CB1FF4EEAF0FC69A4E304F556072DFEEF5C052C886C83E7F58A3DBE9A58DC0A808CCDCEA9F33AE2A0");
	KOLen = asc2hex(right_KO, "40C9C4D032EF3C22F5B3CFD57B872B4FEE8682F4BBE7D1E6DB3DC4D01ECADCCFF0982D101BA668B66E27679C62F76D027AC19597EEC97DC470FF9E5C4E22A51DC1F528582BCA6AC1504386BABACC2D6B9ED73E228E1DF11FB32B5B009526B829DA15B50FA911227371C5E24571410A47B517BEB041F7614BFE2DA26293EA543877ADB30F2E279209844DEA84C84084D1033CDA9175167B20569D65ABC80FA5AFF98A5C0B231D621F1222AAF982B1A7DC891E9B0854D6F8AB859DD10F29B1C29889998D48ECA299E3A5826E44E4269777CE8BF5D2AA902667BC77F5756140FBB93E42B3C92E7DA76B38FDCB70E5C1ED06684BA1F44F46F044B6F423048674D350");

	kbkdf_cmac_feedback_mode(KI, KILen, r, L, Label, LabelLen, Context, ContextLen, IV, IVLen, KO);

	assert(memcmp(KO, right_KO, KOLen) == 0);

	printf("r=8, L=528 \n");
	r = 8;
	L = 528;
	KILen = asc2hex(KI, "154A09E676FFAA09397065EA9C78FD53");
	IVLen = asc2hex(IV, "0E5700A836A8EE7837949D523346DCDA");
	LabelLen = asc2hex(Label, "0E9E571B742ABB1F1D521ABD4FD290B3A56E27F510E0F8441B169301739AA144A652C8292B69CF6AA38D03335E5BD9312117D4ED26A1A95865A4A2A6");
	ContextLen = asc2hex(Context, "1211406067CC24B5A3A52F125389E9F2D0F91FF609BCD13882D14BDD9DA891E919920057D875336AE5C4243EB5AE93A2AD96AC2AE5C4E47F2C5A24FA");
	KOLen = asc2hex(right_KO, "800DFF70AA75A2A3343FCE8F31F6A26379550CC968D2E62B64BF2A4993DDDD467654AEAF696E17DE2622F898EE17F5874887262DC8AEBDEC1F204486FF4FD57BE941");

	kbkdf_cmac_feedback_mode(KI, KILen, r, L, Label, LabelLen, Context, ContextLen, IV, IVLen, KO);

	assert(memcmp(KO, right_KO, KOLen) == 0);

	printf("r=8, L=2064 \n");
	r = 8;
	L = 2064;
	KILen = asc2hex(KI, "19615D2024DF496B5749411CB133DB88");
	IVLen = asc2hex(IV, "04B816BCF96B86105490B1FF798DB835");
	LabelLen = asc2hex(Label, "2F9B3AEAA5C1756FB303AE0661D7D3F7ADD860E089BE7F4D248E73886A0E36B3CE7C6113477F4DAF985E781AD5702A8D23D45838BF61C8DA42E07690");
	ContextLen = asc2hex(Context, "237937EA7D6C9C441202195491C266FF14E72671ED12C76CA23DA9E036F082BDAAB70105C4D3B1250F3021852397425E262510CC93FC74243A386987");
	KOLen = asc2hex(right_KO, "4DAC6D193824C544F44DAA69E2A6648C81E48517221C4577118CA4C88A40C6CF23776CDF34B32BD0A01F5A88F09B86EB6D35BC0151894D4DA6B28ECB4A3A5E702B15B405D95CA3665DD1833BC256E58394348566C4493DE011855ACCE182D138B3EA893A677A3790704229A8AC28220A4F06813C0BE41415067E5E47599B275CF9E5D2B5A35472D73F96DED0880488CDB78D3CCB6D46D29FDC9AF886007FEA2619FC9D8C46EC2FE3200FC8F97244DEE03487EB167D570F1E29DC3D8A856FA6425A3EB901C4C927CF1881AF02EE9FF7AB4492971424F4D669B7775A6E5017A2765001B4D11181B96E8319EAA49EC6BF1FA7BAD576C4AA3983CC5B6D00C517DF97F957");

	kbkdf_cmac_feedback_mode(KI, KILen, r, L, Label, LabelLen, Context, ContextLen, IV, IVLen, KO);

	assert(memcmp(KO, right_KO, KOLen) == 0);

	/******************************************************/

	printf("r=16, L=512 \n");
	r = 16;
	L = 512;
	KILen = asc2hex(KI, "964E705C0C527074BF823F2B722B435E");
	IVLen = asc2hex(IV, "5742F0C51955EA831FC069FB1024E2E6");
	LabelLen = asc2hex(Label, "9215E4A2581340CD5BBC6C13673F2944DA1464AAA9EB5A99A3E20047FAFAA2DEFFCCCAD02D78636B69DF1EAD881215591209AF4A4599C3085DA00099");
	ContextLen = asc2hex(Context, "13838C9A64DAEB8E9369237571531DA1DC8A4FC5868A984FF8476BF7D663309864A5E73F49A70F8293CEC614FC7F31966B901EAFBEFDE85EC7DD9B8F");
	KOLen = asc2hex(right_KO, "E49938DC76A6B7C3846FF254DD4F2E66702E6CA0A9312A3A707F9640C942499BE3149E0D5AB6AC18EEE5E4FB888C96A32161F71523F925FEA0CE26BF5CBC313B");

	kbkdf_cmac_feedback_mode(KI, KILen, r, L, Label, LabelLen, Context, ContextLen, IV, IVLen, KO);

	assert(memcmp(KO, right_KO, KOLen) == 0);

	printf("r=16, L=2048 \n");
	r = 16;
	L = 2048;
	KILen = asc2hex(KI, "B497AB63D560076D9BA3C5DD86681E1D");
	IVLen = asc2hex(IV, "2E7EF58C3F6D0219C2AC2F109E144233");
	LabelLen = asc2hex(Label, "5E95BD0D342802833E04BBAC091579E354AA9B1A166E7271C299A307C967CC0F60CA6A27855BFAE63C975EB41F4883DF154141EB624E8229E06BA78B");
	ContextLen = asc2hex(Context, "8B3427B6439D7959CEE335BD1DC3769ED0E9823AFCABADA72BF77A69A48A0444ED639C4F8F78B44A19A7FC3167EFCA1124E0BF1B8E50A8F77950A25B");
	KOLen = asc2hex(right_KO, "083D14104415A6600767E1E94E49B5982240C6CDFCD47896DEC9BFD3365226F9C591A5D3DF6221DA39DF30B9067B190B1D27EB4A35A49F56911F2BEB8DE6CA3400565C8F30005D7FDA501EAB13D85789865F78C807FD2CB975967D3B68225B18B3910BC7135688086EB3366306250AADA7BC33AEFEF4E7072C5CE6A64FDC898B197CFDB23B85943BA0AD0DB0CDBC10934BBE0D605B2BA84F21C8ADDB32989C0C58807FF723FC3F193B8E317763940D5124E303F58A424E1087691684E30F58F5106BC37E9F5A7FBB8F30C76B1EF87AC6E4BF7E82AB069F4275A00F6FE5BC984F3450C8B7AC7EF85DEF26A328B2E8F65C61FFD58592AA55100E185397F1B9ED22");

	kbkdf_cmac_feedback_mode(KI, KILen, r, L, Label, LabelLen, Context, ContextLen, IV, IVLen, KO);

	assert(memcmp(KO, right_KO, KOLen) == 0);

	printf("r=16, L=528 \n");
	r = 16;
	L = 528;
	KILen = asc2hex(KI, "9AC775FB2910F79C11333DFC97F1530D");
	IVLen = asc2hex(IV, "B3F38DDA13BCB61A63DB6A05CC65C166");
	LabelLen = asc2hex(Label, "BAA22EF2E307A6D885640499EE5FAC1A42216EF8794FAE1BA73CC28E805D9C8D1BFDA9E0F631F8683B0F9FF8411B5B66560276E1BC8BEE84F1CAD32C");
	ContextLen = asc2hex(Context, "3397F187443EAF6E6B783775BB9AD7C0970DA71876FE6D3DE456BD7ECAED6588EEFA087CBDCF084449C3A9268E6F7499F91DDA582B7D1AB6FA9A6531");
	KOLen = asc2hex(right_KO, "2A865CD9798C8B6330C89201096CEF185D1C246797AE16E13DA6E6D77D042344EC506F41BAA893F6D80612BAA9CCB6DC1B28E3F9316A7AD18F630382BF357BE610A0");

	kbkdf_cmac_feedback_mode(KI, KILen, r, L, Label, LabelLen, Context, ContextLen, IV, IVLen, KO);

	assert(memcmp(KO, right_KO, KOLen) == 0);

	printf("r=16, L=2064 \n");
	r = 16;
	L = 2064;
	KILen = asc2hex(KI, "2127FAFFE30D03F02C2036515CD68165");
	IVLen = asc2hex(IV, "7CA3DA5FC36DDD755F3FB7377241421F");
	LabelLen = asc2hex(Label, "5AE87169356AEF24A475038AD020B78DAB2239B2794181228E0E34FF59D0C9F4A1BEEA100F711DD4ED98A38A2DEEA0D9AD697D97B9B48BDED2E0E962");
	ContextLen = asc2hex(Context, "AD57A7017F112B9C780AD4268DF3DEFA7B27867209E26EB58DAD42D0B11D9C0977BD256F7B49FEB6791D5E420EEC7C82C3B5AF7F47F3D3B5FC15F021");
	KOLen = asc2hex(right_KO, "9E3CBD60F4896BEF046A1DF89BBC469F7C3BF9FA361628868600135A58075FECCB67D300FFDA9791DB55BFFFEB9F87E4D4057775B181C5ABACCF46D421F4A4E2EB6F6DCF89369601BD517009ECF55DC74A8662351E99A3B0543C035FA8B2E8BCACEA6C7B5B747FF9B39A3F2DAE7E55F8C35C296B5C0DDBF37D209699D2C44A21651376CD8605E84C0721D6FBD15FF3927F88F56F78DED5BDAAA2BF36A511C8300853296C98012013A704B86E9BBDD7FB9B746C7F4676B85D13BD42645D1335898479F238DD0AF57FB13211891A35BC471C97C04D1FD83A4BA441839D17CFA0199F5535694AC077203F9E0582723FFDCBE50187BA76BEE24DE7E077131A540764AAA3");

	kbkdf_cmac_feedback_mode(KI, KILen, r, L, Label, LabelLen, Context, ContextLen, IV, IVLen, KO);

	assert(memcmp(KO, right_KO, KOLen) == 0);

	/*************************************************************/

	printf("r=24, L=512 \n");
	r = 24;
	L = 512;
	KILen = asc2hex(KI, "61F757020D797FC06EC2A19E4B096BA0");
	IVLen = asc2hex(IV, "62AB1827641D947D4224E1AFA748B99B");
	LabelLen = asc2hex(Label, "C586754955452D7FD98B218F257157741DD4861DC04E330966641A144501CF913A24A598C7D5CFA1585DC552CAB6EA962D416BEFC9B76A0D60625C9F");
	ContextLen = asc2hex(Context, "B38DAF694739B0976911AD5170A0568F42C2692F1A588F45884081B2B9856EF8F8D2A14C752D5FED45E10EB5ABBC9DED967B1F666A83B9C503D2BF1F");
	KOLen = asc2hex(right_KO, "4DDF264A85849F65EB0F545F43AD1760D5342106C362894AE0407C785CF0E3D013845C39EC4C69B427764DC4C00B383AA465B3ED17EAC5C5953135B964A46417");

	kbkdf_cmac_feedback_mode(KI, KILen, r, L, Label, LabelLen, Context, ContextLen, IV, IVLen, KO);

	assert(memcmp(KO, right_KO, KOLen) == 0);

	printf("r=24, L=2048 \n");
	r = 24;
	L = 2048;
	KILen = asc2hex(KI, "92073F00EE40E845A4D15DB13FA81FD4");
	IVLen = asc2hex(IV, "DCFDDAB7323F8D70CF4EECF4A4EA032D");
	LabelLen = asc2hex(Label, "C46C1B4C69B3E1613862C528C649A1265A209BF5F57B4CDD8FFA22A4A4C002A6EF27322876B277E9C6447AFA808F70D014CEFA98CDB74ACA0EAB8801");
	ContextLen = asc2hex(Context, "DB31740A9AA24C3A1B26F005D7DE44CD7563D6F89370C145C2DBD160D2CAE7B451239F804E44312D62F595DFF29AEB4AAEAE19C75D6CB6A6DDCF27C6");
	KOLen = asc2hex(right_KO, "DCA2169932311E2AE70BDE837D3510F68A97C8AAB3E2A423FA38905D96155171493ABE887344683F0F0AD2A1D3B7D05A684AB3977AF1CD06ED6E00513F7FBBB4CFBB5C683592555773DF4599E3F1F7D0B1BD1BCB7CC318FF5FCF5F7F9EEA56668D91F52990AF8E3055578D79DD5EEB9A3C2D1040983972EA238C7531698A7593CD1F737183936351DF9D90559DF672C57C4DD493AC1B6DC453495BC45143685A698DB262CDE35E1826A08C2449A57718DB50B28A800FE8C765BB9AC37CE53790E219DC77D4A12767C687EEA48C71A5A691E0C6BB99E8B72C6359DB63BD3E3583A4AA4752876F483FE95364ADA9EA655A573B3558508A80C61DB53CCE4B7838D6");

	kbkdf_cmac_feedback_mode(KI, KILen, r, L, Label, LabelLen, Context, ContextLen, IV, IVLen, KO);

	assert(memcmp(KO, right_KO, KOLen) == 0);

	printf("r=24, L=528 \n");
	r = 24;
	L = 528;
	KILen = asc2hex(KI, "2B1C56B1F9CB4921156FAA50CFB4CD58");
	IVLen = asc2hex(IV, "A4A8D0ED4DB8C3EDFCDB0C39E20D0AC4");
	LabelLen = asc2hex(Label, "F4FFF9E9EF0D1602997003364AB56C92AC6DEB5BBF2729A3209B471B8A287C289D81FF39DEA32757000AD0FE6224022BD806CDB6AE5E77E2EAA8DA33");
	ContextLen = asc2hex(Context, "D2A5077FAE092F48CF74C449D0A4DB4F1CE9D54AB0D93EA42344F5D1E36B8D28C16CF4F1B00152BFC96A340093A8EAD282EC2D18BD4F06CD24C3EB99");
	KOLen = asc2hex(right_KO, "FB037EA2C914DFC442F2184AA7C5457CBCC343C6A40BB6EEB39B0E25DE98107F3D99E4211A8318EE8E41D2C7AB6E5596C3DA52D945BFF2C125A4A1369DD4854E78B7");

	kbkdf_cmac_feedback_mode(KI, KILen, r, L, Label, LabelLen, Context, ContextLen, IV, IVLen, KO);

	assert(memcmp(KO, right_KO, KOLen) == 0);

	printf("r=24, L=2064 \n");
	r = 24;
	L = 2064;
	KILen = asc2hex(KI, "56C005DCD5208A9CEA25F143A2345D75");
	IVLen = asc2hex(IV, "E13661905E8F1D3EEF54AA4607B8B9A8");
	LabelLen = asc2hex(Label, "7CC876E88E59B3AA263E427F5BBEA2FF3A45DF18C759B3A53FD0F142A040235F6BB87294A9ADC7342C373025177E85EFA16E4B1215B3D89D1DE1B8FC");
	ContextLen = asc2hex(Context, "41F25012ABF6C1882D061064857A83DDDF5C4E6D9B1C6E295184D64E12EFC91CF1B687E7C2EC2B6B224BD460B86D034EBA4044A3B2B4110382B6F3DF");
	KOLen = asc2hex(right_KO, "293ED4FEF85791CAB89E8B8951EA827D5C7FB8EA0DDA6CDAED01A16E4400D3F62D06DD8CCA474297ED8A3484FDE91C4624FD1CADB02B29D2B2B6F8E8681ABB1A9FC88B3F84AB9FBCBE754B399C7DA1A277B4CF9BCBC15FAF0604A25897A9ED484D001BB96699BE125F478E4D1E774475C99A2DB37849C4D013891BCC48155A5F8A12C9C75F8791249E05D66D0E426CDE172A65E6F2957340C934900B7FF22265E9368C14881783BED7AD5BB969028BDFC77E79C374C2F0110B1FAC62B6BF21ED9776BA2C4E33DB0609632315EBD286D79285991D89AE24C545CB935CC1778CCC5EB04DEA22BCED5D6D3DEB42C89945DFBE1B1AA012F3CF427BA6DA5F5020C4FAD2AA");

	kbkdf_cmac_feedback_mode(KI, KILen, r, L, Label, LabelLen, Context, ContextLen, IV, IVLen, KO);

	assert(memcmp(KO, right_KO, KOLen) == 0);

	/**********************************************/

	printf("r=32, L=512 \n");
	r = 32;
	L = 512;
	KILen = asc2hex(KI, "3979B3482B4893FD497B98526130B874");
	IVLen = asc2hex(IV, "BA2CF56A0DCD84A9D1402DE3BBF4F521");
	LabelLen = asc2hex(Label, "864FFB11F09FA0A10553EACC9F6B2BB42E2DDDF2B51AD12A152089E28E11E2948354F5017DDB40C97354013949A4E3649691DC75AABE5643D0DD8D26");
	ContextLen = asc2hex(Context, "D020380AB8F06BC1DCE2BC9E1CE7A53F65C329AA7BC0BA9CF5A35B1D89DF0258890940AAAE8C23F9159E5C4787729D86FDAF45AE63223F0E9DAF27DF");
	KOLen = asc2hex(right_KO, "DC17A96DC2744D28D394E4FCE92D1CACAC77569E80A41B5300CFF28A84678F92F672FB48EF2504584EE20778F9BF092C969A427C6A06C5AA06EBCA7544EF0B9E");

	kbkdf_cmac_feedback_mode(KI, KILen, r, L, Label, LabelLen, Context, ContextLen, IV, IVLen, KO);

	assert(memcmp(KO, right_KO, KOLen) == 0);

	printf("r=32, L=2048 \n");
	r = 32;
	L = 2048;
	KILen = asc2hex(KI, "FDCFC8BFA34A4D8E5AF80A45B5B2C59B");
	IVLen = asc2hex(IV, "5815F442017ADE78CA28FED9A8C9A877");
	LabelLen = asc2hex(Label, "381BEF2CBBE8C52F5E3864E6C0C5EDFBAEAF4FB231716B7ACA1476C2FCA39E0D0BDEF0490432795CFDE9AB019E9F03D2E0F5E9A51589D81C2925BE78");
	ContextLen = asc2hex(Context, "2736A6AEFE8094BD8611B03EBE73A73D58264F47774D8AC4B7A86C886EC2A0A4316C07829A69A331496BB4FD293F2043F4441883FA21F9B71EB770E3");
	KOLen = asc2hex(right_KO, "A3E37C137610E4E3D4AF3FCB96FC623B289CAB2B10B452C98B256DB480DBB3DA3BB4688270817BA8C5C0BF88DBEB22F019C99211638728858BB957B4596F105ED670BE7226E1539AD8411CBBDAE74591FC41D967330AE6A44EB3D1744D7D46CC255A2868D1FDC48F5619E99F9E70C9A8726B99C3B091BB34D0BF14F10C0896ED440A3D271B5964F3A29F238E21F39EF5394607E9BFF4F44628268F2D2CC6434F692E99B65D8A6039BF63F5EE6156A690F289967E941E2ADCFEAFD08EBE6E3939F6B75106DC6D892A4C30B5E4FB2ADADE6DAA315C734EBD46EC3FD534189FD80A8CE036916907596BC162E3D55DD68AC6249295EA7170235494BAF1A86A66F886");

	kbkdf_cmac_feedback_mode(KI, KILen, r, L, Label, LabelLen, Context, ContextLen, IV, IVLen, KO);

	assert(memcmp(KO, right_KO, KOLen) == 0);

	printf("r=32, L=528 \n");
	r = 32;
	L = 528;
	KILen = asc2hex(KI, "CA4BAD08E52F9F964725ACE443BF6C34");
	IVLen = asc2hex(IV, "E377C7E0E49D15F1019483EE753EB9F2");
	LabelLen = asc2hex(Label, "BBB5BA01983C0B9C5B75179364D4D21BE3539D20E2676ADD863320A991FC41142CDECA32E4BD5A37F27E9744BF76CD81A722D96CFD1946715040B5BA");
	ContextLen = asc2hex(Context, "ED3D8248A52EA443D19AD58E93A7F49F5E8EA78EB84D446B3E9CF2D5E9210BC891E7C5B7AF0D12DB67BBC4CAC65AF54B4805A6699D3AA6C6ACD6B632");
	KOLen = asc2hex(right_KO, "972A239FE5ACC6ADE99B0D3DE91353CE1796D7C6EDE14DFCB80142B19253EBAA59585FB96FD34BB2BC669C186E8A73FF2236BBD39F260DE845E0CD349D054E09F3D9");

	kbkdf_cmac_feedback_mode(KI, KILen, r, L, Label, LabelLen, Context, ContextLen, IV, IVLen, KO);

	assert(memcmp(KO, right_KO, KOLen) == 0);

	printf("r=32, L=2064 \n");
	r = 32;
	L = 2064;
	KILen = asc2hex(KI, "C775C8EB99FE725D3689E8F7B6629685");
	IVLen = asc2hex(IV, "82DAD50C5C3F105EA00B26EBC95C10DA");
	LabelLen = asc2hex(Label, "36A4C4592FA2593123916B9D339FC15CF5A02D057104B49B7006EF61F727B1EF0EDBEB86C582CCA179992CCC54322AB913A114910C7988886FB7D9B4");
	ContextLen = asc2hex(Context, "CC3CB41FD581041B668612D5C20BF12D200319C5664652583486D44E2484AC8D5083619115FDD8BF179675F6854E83689FFAD6A875F5AE03F113DF14");
	KOLen = asc2hex(right_KO, "7AE5A89B3D8F9BD612153B402B17F2D4CE312666358FBB7B0D86759894CA93CDA0EC8E7122576F82D3ABFED16F9A2A3126E14625DC623BAA86934DF8D4D55D7A3EAA4E5CB9E11C8C0A09AA7B97D3673D04CB17BB9DECB219A00D2B96E9875548411998B6CA1A159E63D28F2CE3750E3DF30D47F58ED83CF214EA4260C0617BEF96D286DD54B270D20BB61761C391102E849ACEF8777B52EC74AFD9E38845BB19183C30370B0CDC44C682FA497DF0EE2C0A98040D676E3356D3419E6143B735527716F9E011EBE5DE93A0131935A372C884535F142EF72B4C1BD60BE309649B0F039E91B173FAE0D4CE8E7822AEDCF683565AA481D66A508A5666AFD1819D56967683");

	kbkdf_cmac_feedback_mode(KI, KILen, r, L, Label, LabelLen, Context, ContextLen, IV, IVLen, KO);

	assert(memcmp(KO, right_KO, KOLen) == 0);

	// with counter, without IV
	printf("r=8, L=512, without IV\n");
	r = 8;
	L = 512;
	KILen = asc2hex(KI, "30CB19FF4F08D3BA9FD76930D5A7DD69");
	IVLen = asc2hex(IV, "");
	LabelLen = asc2hex(Label, "ABDE4F16E1CA1F2282DA5689690E426D03AC61675735811B4397240F08A429BD09C3A9E6CFE5202A51BBCDD672275BFDCCF0C0CAACB966145D348833");
	ContextLen = asc2hex(Context, "AA93E0129E3F7F868ECDFCDE5A2ED0BCEF25012310FEFED0577ECACE76165D45C35B4893F4BB979D2668FB67259929E3E7F27D075940E3225F6AF770");
	KOLen = asc2hex(right_KO, "3F9BEC7908FF6B0B8CF191D22EFAE38CFFD7F77468D61FA8ADBB42FE069AA266C77CA70F0F0E289EC2E01C69ACE52D90B30590D87ECDE84EE14D0B39A7502361");

	kbkdf_cmac_feedback_mode(KI, KILen, r, L, Label, LabelLen, Context, ContextLen, IV, IVLen, KO);

	assert(memcmp(KO, right_KO, KOLen) == 0);

	// no counter, with IV
	printf("r=0, L=512 \n");
	r = 0;
	L = 512;
	KILen = asc2hex(KI, "D87DFE5827D565193EBB71F9D59640AD");
	IVLen = asc2hex(IV, "98F27D442B7684B96A16C7C9F58A7002");
	LabelLen = asc2hex(Label, "ECFE481DF70BD78D8AE6CD5867D7A02664ED77976EF147DACE983B7CABFC5A7DD04D64A9B0C4FC25A7D90C4983B666AD43EBA7871F636134C8977914");
	ContextLen = asc2hex(Context, "F001CD9B0DD41AA55AEA1E0A1FFEF973331BD96CBF54D6BA44B61BEEE07B473ACD8013842AFA34B9FE6483647ABC5B7F7EEE42885F91CCD8E8D1BD31");
	KOLen = asc2hex(right_KO, "681D5ED7E1BD5C45603072F5CDF43963B600F0815D9C3FDA3911D68FC37D3D9D4CB044B5087E4E90A57499D821EF14EB184C8B015678724544F5C5D38A5428E2");

	kbkdf_cmac_feedback_mode(KI, KILen, r, L, Label, LabelLen, Context, ContextLen, IV, IVLen, KO);

	assert(memcmp(KO, right_KO, KOLen) == 0);

	// no counter, without IV
	printf("r=0, L=512, without IV \n");
	r = 0;
	L = 512;
	KILen = asc2hex(KI, "30CB19FF4F08D3BA9FD76930D5A7DD69");
	IVLen = asc2hex(IV, "");
	LabelLen = asc2hex(Label, "ABDE4F16E1CA1F2282DA5689690E426D03AC61675735811B4397240F08A429BD09C3A9E6CFE5202A51BBCDD672275BFDCCF0C0CAACB966145D348833");
	ContextLen = asc2hex(Context, "AA93E0129E3F7F868ECDFCDE5A2ED0BCEF25012310FEFED0577ECACE76165D45C35B4893F4BB979D2668FB67259929E3E7F27D075940E3225F6AF770");
	KOLen = asc2hex(right_KO, "6C485549EB38DEACDB6A73CA273F151D4DADBB27E205610F9DDD60A5F81BB78288CB20442C87F10C0DA60950124C3228DE5A2D20329B80BE5D661B06A71361D0");

	kbkdf_cmac_feedback_mode(KI, KILen, r, L, Label, LabelLen, Context, ContextLen, IV, IVLen, KO);

	assert(memcmp(KO, right_KO, KOLen) == 0);
}

//KDF-DP(use CTR)(SEED-CMAC)
void test_kbkdf_cmac_dp()
{
	uint8_t KI[1024] = { 0, }, Label[1024] = { 0, }, Context[1024] = { 0, }, KO[1024] = { 0, }, right_KO[1024] = { 0, };
	uint32_t KILen = 0, r = 0, L = 0, LabelLen = 0, ContextLen = 0, KOLen = 0;

	printf("KBKDF-SEED-CMAC-DOUBLEPIPELINE\n");
	printf("r=8, L=512 \n");
	r = 8;
	L = 512;
	KILen = asc2hex(KI, "D87DFE5827D565193EBB71F9D59640AD");
	LabelLen = asc2hex(Label, "98F27D442B7684B96A16C7C9F58A7002ECFE481DF70BD78D8AE6CD5867D7A02664ED77976EF147DACE983B7CABFC5A7DD04D64A9B0C4FC25A7D90C49");
	ContextLen = asc2hex(Context, "83B666AD43EBA7871F636134C8977914F001CD9B0DD41AA55AEA1E0A1FFEF973331BD96CBF54D6BA44B61BEEE07B473ACD8013842AFA34B9FE648364");
	KOLen = asc2hex(right_KO, "C561B16CF036A60B44D384711BE2CDED2EAC625795C90C730348A2BFBAC53002A2BF54306F5A90FC693BFC88B570E384F8B31B1118838432EAD7F2D906FEEE7B");

	kbkdf_cmac_doublepipeline_mode(KI, KILen, r, L, Label, LabelLen, Context, ContextLen, KO);

	assert(memcmp(KO, right_KO, KOLen) == 0);

	printf("r=8, L=2048 \n");
	r = 8;
	L = 2048;
	KILen = asc2hex(KI, "FF2C89F49AA4842009C809F78B6408BF");
	LabelLen = asc2hex(Label, "27FA4D22A8B4A5C9E79C422D480F60AA876F29D6B519D6107D97185CAC16B66EF11A7704E07042793D6584977835D2AE74C6D0E28C9651C9D8F2BF36");
	ContextLen = asc2hex(Context, "AC6ABE4F62810CE65AA9AB063E6E43CB8BF1C2774D9845C32A043B73A143C72D9447678B0497D46F1D45299772204671892A77309A4D511F9449DD35");
	KOLen = asc2hex(right_KO, "0769131704D2DF7F3AE6FBB860E86784E8F19B77B66E009EF322E87C339018B2C8001A86FC318769D1A52BF4C518E506D5A7CFBCE839F97B60D4AAE570D6A34E8DC1601DAB58A695E863E1708EC3DA2EC8FCD87E506B54D3F9138A3D76AC5D28F8531EEBB19CA75073EFE76415E84C5B4ECFCB7E66BA9B4B31E42D4BE0807D44B4DEFEF4AFA73E08CC3C584972942C88A7731D83D49AB78D091FD4ADC227D9F44C6D5A6A6D4366F36C0BC37A443248CF6CE231BCB9E8632592DEE5070752745F03A29D3728EB2AFCAA1C177A70173A7F279A080BD6D7CD1BAD7E13586B2E4783050D6E8E2A3D33E85B0DCDE30A13FC3521226FF1100FC1127DFE57736B7798F6");

	kbkdf_cmac_doublepipeline_mode(KI, KILen, r, L, Label, LabelLen, Context, ContextLen, KO);

	assert(memcmp(KO, right_KO, KOLen) == 0);

	printf("r=8, L=560 \n");
	r = 8;
	L = 560;
	KILen = asc2hex(KI, "09003383459BB736B305A0475DAEEEC7");
	LabelLen = asc2hex(Label, "E24CCD4077D0BB462C98ED5071E6EFC6D8918C5B1CFAED9D634205CAC0BA2CE6FC9B090A96F8B6FF08F01F0C4C28AB0B9F791FC285E5BF710DD0B6A8");
	ContextLen = asc2hex(Context, "566CB75B5276E538CA20F038A24E81755F04D93BE61FB561864474DA39177B8727ADD94F6C4327721B30B21A8318DD34B163C07D36ED15E02AFF55FF");
	KOLen = asc2hex(right_KO, "568B0CF6AD60A2E8488B26AF5434068090AAC46B84041CD78E0A10BB2BD05596FE8AA4FAF55D432B16E9373DD38C0AEA97164F3D7612D505B56852C51172F308D383EB6352A6");

	kbkdf_cmac_doublepipeline_mode(KI, KILen, r, L, Label, LabelLen, Context, ContextLen, KO);

	assert(memcmp(KO, right_KO, KOLen) == 0);

	printf("r=8, L=2400 \n");
	r = 8;
	L = 2400;
	KILen = asc2hex(KI, "B4C3A116F45536BD1ADBFC9838AC46C7");
	LabelLen = asc2hex(Label, "C7F2E1EFA3A23DD157B2CE229B86B2961BAB943F7AC7D01597D0D8D60F7DD61003FA937B1BE0978DCA649249D4CFFA580E2EF65A654A7B7E22DAB450");
	ContextLen = asc2hex(Context, "6DF8A8D30FD217D07CA2A46D10E03A0199B5A82716B48E12BEC57D2044615AB15A05033974E03594CECFAE9AB08C8EF4F123032EBAA5250C8C1F1F22");
	KOLen = asc2hex(right_KO, "94AF8D19FA38F0A5502613E4F7BC558818A2001F511F8B0EF6886FED93E5F02A3289A218221B7EF6841033835E3567B6719EDB44F19B6577FC26312359174351DD632B081E16CDE0DF7515C8E0BF7EF4AC6E0670E1F93999120FF30CC146FDC765193819829657FE8CBB733E6643E621FE658076EA7B8CFDC5C78EE27A75014BBE75C2B18007AF78ADC3D0B50B13E8A8AF149E6E51722489ACB92202A6F5B63A3D4DD24B24A2C45A6CC30400F2D9D0A905D784D0F06BFB922E89CC7E5A379CB1D9AD65DFE9895ED4A4AC9877A46FF4DBB6C0DF72D47B1FEE993B0884D704595EA2EBD66864C83323C943508BDA0B6270E6AF56F76C08DE353DA44A82CAA69B0997025D9DAA8C107992F9E8C675A061A116009F79A3726529FABF79958E110A312D72DF3B811838898A703345");

	kbkdf_cmac_doublepipeline_mode(KI, KILen, r, L, Label, LabelLen, Context, ContextLen, KO);

	assert(memcmp(KO, right_KO, KOLen) == 0);

	/******************************************************/

	printf("r=16, L=512 \n");
	r = 16;
	L = 512;
	KILen = asc2hex(KI, "FC7DB9FEB5A973565BF422DD49D7A6FF");
	LabelLen = asc2hex(Label, "1234B0BF7A45E04BC5D32AD435A87E9CCE46A8515CD97599B76B17EE4657CAACC200B8683CC21A846229A100FE611493BFEE3AFB3C9DFA9136BBC120");
	ContextLen = asc2hex(Context, "1D8424F7D6DEC73DBC487D85E50DB0A2A6BD04BD59DD37A55DDE4C655F4CE81CD848FC09D738A4E601BD4F77D6E6216236A39541237C67F6C882B13E");
	KOLen = asc2hex(right_KO, "9990CB05C83FEB96C9A32553820CC92D2924F10AFC4782F6C344B736177E55F9FBCF6187154011B7F2FE3FE7171B040E08C6C083B73EA2338555321B7DFC34D8");

	kbkdf_cmac_doublepipeline_mode(KI, KILen, r, L, Label, LabelLen, Context, ContextLen, KO);

	assert(memcmp(KO, right_KO, KOLen) == 0);

	printf("r=16, L=2048 \n");
	r = 16;
	L = 2048;
	KILen = asc2hex(KI, "1F789ECCD5B125E2D3375646FEE9E4F1");
	LabelLen = asc2hex(Label, "409C9E82891198D5132485D7EB456899AD2C6CA38EC90F8AA07A86C552815DBC36B55F220877B585EBE85223F55A8E00EE04103555F9F28BA45B2048");
	ContextLen = asc2hex(Context, "D6CB014925255A51186A6FA1BDFE6BC9331401BD6C66542B3129140C6740EA7A90B017C1955458B8C2D20C5212CD9870AD5C0BF9AFBBFE2D2B41BF36");
	KOLen = asc2hex(right_KO, "FF047F03502FE82FFFB980F46C07E34C1A6BDF9A25798BE19BD3DC4C057F1BC1187DE2CC908135974C9EC1C58D3357763B0C8F2EE34A4D35A7FAC091E5F2CBA4DBD8252F2D49DAABB57453C64F0FEF25AF6B570DA7D2F8CE32B681B0C3AA469DE7AD4F063C93514465058C9FD30AE6867C81B21770B6D0714C52276EDF68A0783B30FDC70C3B39838A3779D206FDEEC53F8A45577974F3EE22D10285895C5279C4F93352C0DA1E55EED9F31F7841DD482253AE24CD4450D31EB00EFAA60DEA5CB7A493E9D155344B8EB1F99D91C41F72DC0507D2E10F78A6FE4BFE04DC5FA349172D11E26B3F714CDCBE14ADD628EEFB5FDE88603D5196281FDBCF2B0AD7236C");

	kbkdf_cmac_doublepipeline_mode(KI, KILen, r, L, Label, LabelLen, Context, ContextLen, KO);

	assert(memcmp(KO, right_KO, KOLen) == 0);

	printf("r=16, L=560 \n");
	r = 16;
	L = 560;
	KILen = asc2hex(KI, "993DB650E0C640821FCF1D4503DA125E");
	LabelLen = asc2hex(Label, "0FF350499C9E9AD01E0EA5DDAA97C48DB566C5851F70158970A82B4B617524809E63AB39CA191C71C38BE9E228703C1E19F7DEDA3EB5578D0BE2573A");
	ContextLen = asc2hex(Context, "42C65489B96E751D5DA3AF22771D2E252EF3F6294D56CAF7477F4CB579E667BAAEB5EAA1E87C759C5E26990BC12C3B4EC30839D7DAED518341B53E2A");
	KOLen = asc2hex(right_KO, "78866AD1750F36F13B6E59CA2581A074C65DB6D2A7D9CF440D3C5777334D29F53695554291BC9DCEF9D4FA1965EE2651567211F670FCA3630DA51394435C0207D1B9D112640A");

	kbkdf_cmac_doublepipeline_mode(KI, KILen, r, L, Label, LabelLen, Context, ContextLen, KO);

	assert(memcmp(KO, right_KO, KOLen) == 0);

	printf("r=16, L=2400 \n");
	r = 16;
	L = 2400;
	KILen = asc2hex(KI, "2894A79CA481F9971B233D8A45E48846");
	LabelLen = asc2hex(Label, "7B41AC65C1C65BDE033A8FD69F1728B9243DD78A59E63C7782DD4BB1DEEBF47A7492038010FE45698839ECAF439E34AEFC9047FBC46C5EF846BB2AA5");
	ContextLen = asc2hex(Context, "4FAD72B98EC3FDF298CBB2A92E11FEA9C3D4764139F7BE98ECF9A941F127A10FA0104A2B4F3A62636113ECC5802A8D6D269F369B62D90309D976637B");
	KOLen = asc2hex(right_KO, "6413DD4415A4CFEA72E4788D660524E00BA4E1669C24AA979044F15188E51D8719F0F9BB54A1E010515FB18C1F7006DDDF123F92CCCE6B668079C420248F683DB8CC91F9257EB14915CF87610AD17D887A385532F367CEECEDF633E64018C1A8BEDAE75169B083354FE6543EA0D44DA3089B25E76D21C21F6A621A73786C4F5D115B17FAE1FF6FB9FACD2E78FB1397E82CE2550E4A35FE9F51812623319A3ED26D59E73C8B088C5F14D0F118B26598299C9ADA2E08B0105A1284953C3581AB3A59539DE7C79581698348FF5AA139403F7645B808C1BA8AA052C62DF9B6AD348E9DAC06B7C026059BEE84AC40BFD636540A241E3FC1DD79E936B5090A8F0CFAA234C1FED8402E2BC27B74F48CD607DCB9A37A83B6BB4EEFCB16F95867A2CB5E155A510CC202625FDBB9826EA2");

	kbkdf_cmac_doublepipeline_mode(KI, KILen, r, L, Label, LabelLen, Context, ContextLen, KO);

	assert(memcmp(KO, right_KO, KOLen) == 0);

	/*************************************************************/

	printf("r=24, L=512 \n");
	r = 24;
	L = 512;
	KILen = asc2hex(KI, "C88754012EBBC6C2E6DEBB06F17EDAEA");
	LabelLen = asc2hex(Label, "C2D0D56644A291DE1F9187F3387C6A9F76390981CC86787574426A6878DDE26B770D0B05A6C263CE155D1F39341CCCB295D932E9F3F57D6D748F9F7C");
	ContextLen = asc2hex(Context, "2BF9F01AE16C176015FA2E1741C521855F6F5787ACD195E0ACF01FD16E2C20EA11BB4B1F8756C31E993238E02B32537EC25B55474388FB0FFE5FA4C9");
	KOLen = asc2hex(right_KO, "B87350DCBB8D0921CD68415BF74C77C55639CFE92B4E0E485C77029E7BBDAC44DC20AD1E444CA5AB9FB6E5D4524F171688BFB27FC0BCA11A11BA2D0D8DD2C43B");

	kbkdf_cmac_doublepipeline_mode(KI, KILen, r, L, Label, LabelLen, Context, ContextLen, KO);

	assert(memcmp(KO, right_KO, KOLen) == 0);

	printf("r=24, L=2048 \n");
	r = 24;
	L = 2048;
	KILen = asc2hex(KI, "B75EE40FCB8D5BE4DCE8DBEA7464DCCC");
	LabelLen = asc2hex(Label, "6029311FB48B30F20F3D12A620C19D006923007C43E7FEE423404E221B834253A4DAA81C9A3DEE41889E89732664966A201BC234196A68CDF045FAEF");
	ContextLen = asc2hex(Context, "4263A22B30F32939628B178D4B611C2AAFBDAEBB63AEF4E055FDE3C6CC5FA7FAF0EE447F8CDA7D1E135CF5FDE1EC9473C4B42C1BBB445C27FD87B5F7");
	KOLen = asc2hex(right_KO, "5294C2C9F58D354D7E581FEEC760EC481D5D8BDFF2BF1FACB1BA59DDE29BEE945FC08BDF8E797DE93CDAB5F77220FFFCF9502BF36BE8553D1A541162E41778ADD7DD191A4E1EB78EC2BFD472C628FC7C8C8BDB4EE6421F5B779073EC6EC4F8DFE6074345C35709F99C0565F0470616B69CEA2BC4BA309026CB61FA002119D0E5FCED2EE15CE01FE9EDCAD2D7F2202063FBE412D77A0798CFC8BC7301DAB7C6CED362B8D024B46D8C67136234BEA848892CBF2734663942D8E23138351D28053FAE29AED28A36E3D717531F75F727D6CB87751E66E20100190368DE0C12698280F9B916AD875990BDC31398351C86427EC91043719D93F2A58D443F8322F62A42");

	kbkdf_cmac_doublepipeline_mode(KI, KILen, r, L, Label, LabelLen, Context, ContextLen, KO);

	assert(memcmp(KO, right_KO, KOLen) == 0);

	printf("r=24, L=560 \n");
	r = 24;
	L = 560;
	KILen = asc2hex(KI, "71A4BA99074FAD1F9A6A23A87C8CA4AD");
	LabelLen = asc2hex(Label, "1314669FDC1A6D7BB0A6F69F461F16DCFA069FCCCCE44365AC80FCCFF556AB733745FF55398898A33EE76C8E882E6A581BDF5EAEC32415395807C170");
	ContextLen = asc2hex(Context, "41E59EB03720D68E4B15A36C2B4EB34AA1F8D0DF5C97C0E8F3F86AC127673B326923C88B9C0FB5F31BAAD5FDFE41927C9964909946968D2265488C25");
	KOLen = asc2hex(right_KO, "E72B78113D5D5549E7028FEAC5AD17FBCDCF118367EC719EF00E7A411FF241E6466C0914D573D57014C11CC1113E12C0BA641692A0E163A415A56ABD86393979462F21E19EDE");

	kbkdf_cmac_doublepipeline_mode(KI, KILen, r, L, Label, LabelLen, Context, ContextLen, KO);

	assert(memcmp(KO, right_KO, KOLen) == 0);

	printf("r=24, L=2400 \n");
	r = 24;
	L = 2400;
	KILen = asc2hex(KI, "B3207DAEB09CF2D2FCCD58F0F431888D");
	LabelLen = asc2hex(Label, "D79B5738CA28BE1A1F7438CFD60E6C7464290C01B494FDD96CECB8A07110F04DADD5758010FB5815D46050F906745C3C42EDAA68BEBCB812893FB9AE");
	ContextLen = asc2hex(Context, "15B83AA8F4FE05B0DF724555FC35ECD561985233D4D41E8BD4FC6AA3DE2F22C2E912ADC5337DD06F3F75CF011E5BD50AEF629581A2473211013C5CB4");
	KOLen = asc2hex(right_KO, "423D91EA8EFF7E3304B6CCFC82F485E287D15D9D44A226ABE682A2F23D033F93BBC829F1BD044A8ED39D364EC686CB56975985A6E98BA07C4FE44200D97CE7B87BFA05D9A0EA2F1DE3061D27CA32247B0250EBBAD71A254C923E4E1CF47CD86334EA20A3BDA1EEBEE2A9E01F2AF2C4813B1E1A4854764DC35CEF06F20D87DD8306BCA0D929A2825EBE25A1ACA3FB3B071F99166870F86F9488A27D52859EEE29EC2842647BF421AB1B9E9643FFB94474C9B61964DC14286106F5E1083A45B9651AD4ECF9DD6A55B164F2A48C9041FADEF82960C19486B42CF58CBC3DFF284F28E84ACF0CEA0C152F121B3B37A67ECAB19B7AFF54F148CD32BCB3F13AD044F817A6EB900E93651DFEEE528C8579C53215B64DEFF6C2149E13624A78C1A3277D298F97EA25F652A51CDEC0BF43");

	kbkdf_cmac_doublepipeline_mode(KI, KILen, r, L, Label, LabelLen, Context, ContextLen, KO);

	assert(memcmp(KO, right_KO, KOLen) == 0);

	/**********************************************/

	printf("r=32, L=512 \n");
	r = 32;
	L = 512;
	KILen = asc2hex(KI, "7BDB11A0D24B9E9F21BB7EB30BCC1AAD");
	LabelLen = asc2hex(Label, "E9072B7ACACED7B0B8921C673E47724A2715ACEE8751206200AB07073EA927A1C454AFAFEB3162F82772F7678D6EC018924F8BB3160AC6F9A195E69C");
	ContextLen = asc2hex(Context, "EC540954A3D4D92F69BBB4291DFF0BFC5B57083946EF74988560D78C8CDFE11B1DB408ED0EEF73A34C56176A20A120CFB1EA92D5CB5F3044DE3A9D45");
	KOLen = asc2hex(right_KO, "046C5A33258836CF516E432332276451CBC1D9991DCDE0F9423D6438163523A4723D579B697F95556B1A99B2BE05BDEF738AE215B9060FF2CD9BD950E8044A1B");

	kbkdf_cmac_doublepipeline_mode(KI, KILen, r, L, Label, LabelLen, Context, ContextLen, KO);

	assert(memcmp(KO, right_KO, KOLen) == 0);

	printf("r=32, L=2048 \n");
	r = 32;
	L = 2048;
	KILen = asc2hex(KI, "061F9BFFBC776667641BDA222D15328F");
	LabelLen = asc2hex(Label, "C7E045386A65AD5E1A2928D929C43E1FFD9525A214B4E15F4428AFB3485AA47178CA9233D8012BED54C769C84A952D2D494D261F1929F4CFFBF18D6A");
	ContextLen = asc2hex(Context, "3172E036C12BB9DD7749E50929D696303E2D09B271B16521D3BEE7DF0FE03CEFF2432E052B6B83DF4F2522D820BE78BB0E721AD5FE27AC4E4B5C01B9");
	KOLen = asc2hex(right_KO, "7C9FBCD8F59A7709137DFED7EF996E2590BDDC6D805F648B34FBAF22248A288EA06A392FC0DE77D6FCEE2152F14AA9462F957DF685D5A1B1819ABA341E06614E6D35AE9DD394C205785846A02E08DE08D16B8AF0D611C8EA3E84378DC3653D362A43C347A5529B72BCD01B63D229289B870689773B75536800352FDFE94B47BC9DC3D3CD6499F6FE7DA6CF136AA37EB7476D8F5644FAEEECD55A8B3B13588ADCE7BD3961637FFF729AAC5F8C7585285A6DDD272D08A3810D730A31D9B8B91CFC039E17028563E067CD5EDF952A82E26A8E0318CF277A174A171329C3EB4E9CAB3FA0E7D7CC70FC729BCF5A365C1BDD3D00A961D6EB9F8F939EDE7AAEE47AB4C4");

	kbkdf_cmac_doublepipeline_mode(KI, KILen, r, L, Label, LabelLen, Context, ContextLen, KO);

	assert(memcmp(KO, right_KO, KOLen) == 0);

	printf("r=32, L=560 \n");
	r = 32;
	L = 560;
	KILen = asc2hex(KI, "CF75809EF977404B6418F3AF0805E4F4");
	LabelLen = asc2hex(Label, "2EF04C817785768621A021D486BD26F3E5B05A6E6596B672570BB597BC9DFEFE0781439C248569D5B846E94DABA376FBE471E07F537038B5357E358A");
	ContextLen = asc2hex(Context, "930BD60E0CCD49CBD5B50C56FE215223F753A89D5222D876CAEF0D3C85DB392E9637B44DC63D26B694FDA62E7A9923FF72B50303B92A0BFED3FA7F30");
	KOLen = asc2hex(right_KO, "8F26893BE7F500C65EFE96B11926061FD0356AD2CDC134E412B476722488AE698CBE8133F3D9B2FFEDAA31EB8C4F8504249A1A1322B0962B58C36AB940EAE12563A6936827DB");

	kbkdf_cmac_doublepipeline_mode(KI, KILen, r, L, Label, LabelLen, Context, ContextLen, KO);

	assert(memcmp(KO, right_KO, KOLen) == 0);

	printf("r=32, L=2400 \n");
	r = 32;
	L = 2400;
	KILen = asc2hex(KI, "96A5658C56E560ADFC1A8B0A87D684DC");
	LabelLen = asc2hex(Label, "1A3F24A7FE09A6C7E9A10B4B81ABBC071CAF72E5CA0F537C953D5EE4072A08C8ED0227BC5B1610D1F01AFC675B90B1431E845EE2927AC60C2CA5A0AC");
	ContextLen = asc2hex(Context, "FE593EDE81C36E4A91D89EB1B98B43C5B1437B3E258CF02AB80C008449BA1C09754A6E475DEBBFF7A935978CCD5DA60C8AAC621FB82FF26644AF4B0D");
	KOLen = asc2hex(right_KO, "B2C908D51CA7960A734D5E8350660D079028671FADD1723C861EEAB002BAACBC46F91455DA7569C41107A4D850D52A8B1908627970CDE99C5B1FBEC086FF28308246BFC2DD1F7CEB06EE65A9D6FD839EA990836164B30E0AA9E3DD0F29E96B997683D041CA4C9648475BEC149796ECF00B55FE06F355FF99A7ECF6EE4C00C5BB7CE2EFDD49C52ED2355D12607D6AF9EDA1FDE917D439E18396C335D130CDBC9E808BB892C4E03CBD516AEA9F029C51D36B4FBF3309B1B91D1C7205440C856633349F96F873EF7895393612D171449066832470D78EAA481D59F12E55D4E5CC993FD6DEA120BF80FC9113A83DEDBB279D7E0C1622203DD8761E3B392A21D9D505BA5B64E91A84C685DB9BC9B666AF268EAAD3E10504AA06DFCE4EA58DE5DD56A6A28B8AF8EE74DF5609C04D8D");

	kbkdf_cmac_doublepipeline_mode(KI, KILen, r, L, Label, LabelLen, Context, ContextLen, KO);

	assert(memcmp(KO, right_KO, KOLen) == 0);

	printf("r=0, L=2064 \n");
	r = 0;
	L = 2064;
	KILen = asc2hex(KI, "9D2D75E146CFFC485BEFB7FFB790F236");
	LabelLen = asc2hex(Label, "A072BDCA4986915E9BA436AD3580E31EB2DBA89A2AF6099AFB4CEC84C980B537C395AFE4285DAE210A34F23853EE4FC5050D8B80C63708579BE8A2C0");
	ContextLen = asc2hex(Context, "F465DB4DE9F13680C342E0E2BE36954F0DC3C2941F2CE73C217B40A6C42BA45B4025AD9F99EE1946201E70C93E14E7996DE885B387A1847543A8FAB0");
	KOLen = asc2hex(right_KO, "0166F6977897A0EE1CCDB5DA0A80312B76649BE3BC64432B28ED83FBF5E284A974E0951A0800846694798B844A81994D9EFA290FB0C3643184283844728291869B892744D50E05C1953E2C8A17BBD5CEEC37F2715ED3F6F7012C5799D83359A214020B335CEEE77DA55D614552B49A6AABC2603F080F157D886D0C3C7B100E15ED14F5F24B9523782FB1D3A6F4961EB0FAFC2BA8C468F5E7E067B813DAD72FB74EC66AEAC91E393F9ABB3F4F94512DF9AAF940C537770139E64DD94D234EDADD1B50C0E726438514D8CEDFA7B80B7EBF9B76F54CB529336B6D2BCC229250E4997E0848E47FFC875E0FABAC424A92C5FE3F62DF0B097A496B251C2B407084C8049446");

	kbkdf_cmac_doublepipeline_mode(KI, KILen, r, L, Label, LabelLen, Context, ContextLen, KO);

	assert(memcmp(KO, right_KO, KOLen) == 0);
}